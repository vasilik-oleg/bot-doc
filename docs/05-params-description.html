<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5. Описание параметров | Документация торговых роботов компании &quot;Викинг&quot;</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" href="/bot-doc/favicon.ico">
    <meta name="description" content="Руководство пользователя, описание алгоритма и API">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/bot-doc/assets/css/0.styles.cb6403b3.css" as="style"><link rel="preload" href="/bot-doc/assets/js/app.e81ab8fa.js" as="script"><link rel="preload" href="/bot-doc/assets/js/3.5b3b6265.js" as="script"><link rel="preload" href="/bot-doc/assets/js/6.8be4ae1f.js" as="script"><link rel="preload" href="/bot-doc/assets/js/10.8c8ad779.js" as="script"><link rel="prefetch" href="/bot-doc/assets/js/11.55febb22.js"><link rel="prefetch" href="/bot-doc/assets/js/12.d623e0fe.js"><link rel="prefetch" href="/bot-doc/assets/js/13.1823ce22.js"><link rel="prefetch" href="/bot-doc/assets/js/14.ad5d64ed.js"><link rel="prefetch" href="/bot-doc/assets/js/15.9af162a9.js"><link rel="prefetch" href="/bot-doc/assets/js/16.9bde9826.js"><link rel="prefetch" href="/bot-doc/assets/js/17.ee50ca3e.js"><link rel="prefetch" href="/bot-doc/assets/js/18.87554097.js"><link rel="prefetch" href="/bot-doc/assets/js/19.9fcead24.js"><link rel="prefetch" href="/bot-doc/assets/js/4.69016f4b.js"><link rel="prefetch" href="/bot-doc/assets/js/5.74b65c17.js"><link rel="prefetch" href="/bot-doc/assets/js/7.fcd9b261.js"><link rel="prefetch" href="/bot-doc/assets/js/8.18baa8b6.js"><link rel="prefetch" href="/bot-doc/assets/js/9.f3d86c02.js"><link rel="prefetch" href="/bot-doc/assets/js/vendors~docsearch.30c42ed6.js">
    <link rel="stylesheet" href="/bot-doc/assets/css/0.styles.cb6403b3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bot-doc/" class="home-link router-link-active"><img src="/bot-doc/images/vkg_logo.svg" alt="Документация торговых роботов компании &quot;Викинг&quot;" class="logo"> <span class="site-name can-hide">Документация торговых роботов компании &quot;Викинг&quot;</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bot-doc/docs/" class="nav-link router-link-active">
  Документация
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/bot-doc/docs/" class="nav-link router-link-active">
  Документация
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bot-doc/docs/01-change-history.html" class="sidebar-link">1. История изменений</a></li><li><a href="/bot-doc/docs/02-introduction.html" class="sidebar-link">2. Введение</a></li><li><a href="/bot-doc/docs/03-getting-started.html" class="sidebar-link">3. Начало работы</a></li><li><a href="/bot-doc/docs/04-creating-connection.html" class="sidebar-link">4. Добавление подключений</a></li><li><a href="/bot-doc/docs/05-params-description.html" aria-current="page" class="active sidebar-link">5. Описание параметров</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bot-doc/docs/05-params-description.html#_5-1-параметры-транзакционных-подключении" class="sidebar-link">5.1. Параметры транзакционных подключений</a></li><li class="sidebar-sub-header"><a href="/bot-doc/docs/05-params-description.html#_5-2-параметры-портфеля" class="sidebar-link">5.2. Параметры портфеля</a></li><li class="sidebar-sub-header"><a href="/bot-doc/docs/05-params-description.html#_5-3-параметры-инструментов-портфеля" class="sidebar-link">5.3. Параметры инструментов портфеля</a></li><li class="sidebar-sub-header"><a href="/bot-doc/docs/05-params-description.html#_5-4-параметры-уведомлении" class="sidebar-link">5.4. Параметры уведомлений</a></li><li class="sidebar-sub-header"><a href="/bot-doc/docs/05-params-description.html#_5-5-параметры-позиции" class="sidebar-link">5.5. Параметры позиций</a></li><li class="sidebar-sub-header"><a href="/bot-doc/docs/05-params-description.html#_5-6-список-проверок-параметров-портфеля-при-создании-редактировании-портфеля-бумаги" class="sidebar-link">5.6. Список проверок параметров портфеля при создании/редактировании портфеля/бумаги</a></li></ul></li><li><a href="/bot-doc/docs/06-algorithm-comments.html" class="sidebar-link">6. Примечания к алгоритму</a></li><li><a href="/bot-doc/docs/07-order-error.html" class="sidebar-link">7. Ошибки заявок</a></li><li><a href="/bot-doc/docs/08-c-api.html" class="sidebar-link">8. C++</a></li><li><a href="/bot-doc/docs/09-faq.html" class="sidebar-link">9. Часто задаваемые вопросы</a></li><li><a href="/bot-doc/docs/10-api.html" class="sidebar-link">10.API фронта 2.0</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_5-описание-параметров" tabindex="-1"><a href="#_5-описание-параметров" class="header-anchor">#</a> 5. Описание параметров <div class="anchor-container" data-v-72af3cd3><span id="описание-параметров" data-v-72af3cd3></span></div></h1> <h2 id="_5-1-параметры-транзакционных-подключении" tabindex="-1"><a href="#_5-1-параметры-транзакционных-подключении" class="header-anchor">#</a> 5.1. Параметры транзакционных подключений <div class="anchor-container" data-v-72af3cd3><span id="параметры-транзакционных-подключений" data-v-72af3cd3></span></div></h2> <p>При добавлении нового транзакционного подключения необходимо заполнить ряд полей. Количество и тип полей зависят от биржи/рынка, к которым выполняется подключение. Далее дано описание полей для поддерживаемых бирж и рынков.</p> <h3 id="_5-1-1-московская-биржа-фьючерсы-и-опционы" tabindex="-1"><a href="#_5-1-1-московская-биржа-фьючерсы-и-опционы" class="header-anchor">#</a> 5.1.1. Московская биржа: фьючерсы и опционы <div class="anchor-container" data-v-72af3cd3><span id="московская-биржа:-фьючерсы-и-опционы" data-v-72af3cd3></span></div></h3> <p>В настоящее время для подключения к рынку фьючерсов и опционов Московской биржи используются только подключения по протоколу TWIME, проколы FIX и Plaza II не поддерживаются.</p> <h4 id="_5-1-1-1-name" tabindex="-1"><a href="#_5-1-1-1-name" class="header-anchor">#</a> 5.1.1.1. Name <div class="anchor-container" data-v-72af3cd3><span id="p.name" data-v-72af3cd3></span><span id="name" data-v-72af3cd3></span></div></h4> <p>Поле для задания имени подключения. Это значение пользователь задаёт для своего удобства, чтобы потом в списке транзакционных подключений ему было проще ориентироваться. Разрешенные символы: <code>_ a-z A-Z 0-9</code></p> <h4 id="_5-1-1-2-conn-type" tabindex="-1"><a href="#_5-1-1-2-conn-type" class="header-anchor">#</a> 5.1.1.2. Conn type <div class="anchor-container" data-v-72af3cd3><span id="conn-type" data-v-72af3cd3></span></div></h4> <p>Тип подключения. Поддерживаются TWIME.</p> <h4 id="_5-1-1-3-twime-server" tabindex="-1"><a href="#_5-1-1-3-twime-server" class="header-anchor">#</a> 5.1.1.3. TWIME server <div class="anchor-container" data-v-72af3cd3><span id="twime-server" data-v-72af3cd3></span></div></h4> <p>Адрес TWIME-сервера биржи, к которому будет выполняться подключение.</p> <h4 id="_5-1-1-4-twime-credentials" tabindex="-1"><a href="#_5-1-1-4-twime-credentials" class="header-anchor">#</a> 5.1.1.4. TWIME credentials <div class="anchor-container" data-v-72af3cd3><span id="twime-credentials" data-v-72af3cd3></span></div></h4> <p>Credentials предоставляются брокером.</p> <h4 id="_5-1-1-5-trading-account-s" tabindex="-1"><a href="#_5-1-1-5-trading-account-s" class="header-anchor">#</a> 5.1.1.5. Trading account(s) <div class="anchor-container" data-v-72af3cd3><span id="trading-account(s)" data-v-72af3cd3></span></div></h4> <p>Торговый счёт, его можно найти в привязанном к счёту терминале или запросить у брокера.
<img src="/bot-doc/assets/img/5-1-1-7.ad5d237b.png" alt="Alt"></p> <h4 id="_5-1-1-6-twime-comment" tabindex="-1"><a href="#_5-1-1-6-twime-comment" class="header-anchor">#</a> 5.1.1.6. TWIME comment <div class="anchor-container" data-v-72af3cd3><span id="twime-comment" data-v-72af3cd3></span></div></h4> <p>Уникальный идентификатор для всех заявок для данного подключения, задаётся пользователем для собственного удобства (если не используется, оставляйте пустым).</p> <h4 id="_5-1-1-7-round-robin" tabindex="-1"><a href="#_5-1-1-7-round-robin" class="header-anchor">#</a> 5.1.1.7. Round robin <div class="anchor-container" data-v-72af3cd3><span id="round-robin" data-v-72af3cd3></span></div></h4> <p>Включение и выключение режима <code>Round robin</code> для данного подключения.
Подробнее о <code>Round robin</code> - <a href="/bot-doc/docs/05-params-description.html#s.client_code">здесь</a>.</p> <h4 id="_5-1-1-8-max-trans" tabindex="-1"><a href="#_5-1-1-8-max-trans" class="header-anchor">#</a> 5.1.1.8. Max trans <div class="anchor-container" data-v-72af3cd3><span id="max-trans" data-v-72af3cd3></span></div></h4> <p>Лимит транзакций в секунду. В анкете пользователя указана производительность логина в единицах производительности, где 1 единица равна 30 транзакциям в секунду.</p> <h4 id="_5-1-1-9-reserved-trans" tabindex="-1"><a href="#_5-1-1-9-reserved-trans" class="header-anchor">#</a> 5.1.1.9. Reserved trans <div class="anchor-container" data-v-72af3cd3><span id="reserved-trans" data-v-72af3cd3></span></div></h4> <p>Количество зарезервированных транзакций в секунду для заявок на удаление. Использование данного параметра уменьшает количество выставлений заявки, доступных за одну секунду, но позволяет увеличить вероятность того, что робот успеет отдернуть (снять) заявку при уходе цен.</p> <h4 id="_5-1-1-10-move-order" tabindex="-1"><a href="#_5-1-1-10-move-order" class="header-anchor">#</a> 5.1.1.10. Move order <div class="anchor-container" data-v-72af3cd3><span id="move-order" data-v-72af3cd3></span></div></h4> <p>Разрешить или запретить использование приказов на переставление (изменение) заявки для данного подключения.</p> <h4 id="_5-1-1-11-bind-ip" tabindex="-1"><a href="#_5-1-1-11-bind-ip" class="header-anchor">#</a> 5.1.1.11. Bind IP <div class="anchor-container" data-v-72af3cd3><span id="bind-ip" data-v-72af3cd3></span></div></h4> <p>IP-адрес, с которого будет проходить подключение к бирже. IP должен быть указан в договоре. Если не указан, то обратитесь в поддержку.</p> <h3 id="_5-1-2-московская-биржа-фондовыи-и-валютныи-рынки" tabindex="-1"><a href="#_5-1-2-московская-биржа-фондовыи-и-валютныи-рынки" class="header-anchor">#</a> 5.1.2. Московская биржа: фондовый и валютный рынки <div class="anchor-container" data-v-72af3cd3><span id="московская-биржа:-фондовый-и-валютный-рынки" data-v-72af3cd3></span></div></h3> <p>В настоящее время для подключения к фондовому и валютному рынкам Московской биржи используются подключения по протоколу FIX и TWIME, другие протоколы не поддерживаются.</p> <h4 id="_5-1-2-1-name" tabindex="-1"><a href="#_5-1-2-1-name" class="header-anchor">#</a> 5.1.2.1. Name <div class="anchor-container" data-v-72af3cd3><span id="name" data-v-72af3cd3></span></div></h4> <p>Поле для задания имени подключения. Это значение пользователь задаёт для своего удобства, чтобы потом в списке транзакционных подключений ему было проще ориентироваться. Разрешенные символы: <code>_ a-z A-Z 0-9</code></p> <h4 id="_5-1-2-2-conn-type" tabindex="-1"><a href="#_5-1-2-2-conn-type" class="header-anchor">#</a> 5.1.2.2. Conn type <div class="anchor-container" data-v-72af3cd3><span id="conn-type" data-v-72af3cd3></span></div></h4> <p>Тип подключения. Поддерживаются варианты FIX и TWIME.</p> <h4 id="_5-1-2-3-server" tabindex="-1"><a href="#_5-1-2-3-server" class="header-anchor">#</a> 5.1.2.3. Server <div class="anchor-container" data-v-72af3cd3><span id="server" data-v-72af3cd3></span></div></h4> <p>Адрес FIX-сервера биржи, к которому будет выполняться подключение.</p> <h4 id="_5-1-2-4-sendercompid" tabindex="-1"><a href="#_5-1-2-4-sendercompid" class="header-anchor">#</a> 5.1.2.4. SenderCompID <div class="anchor-container" data-v-72af3cd3><span id="sendercompid" data-v-72af3cd3></span></div></h4> <p>Значение данного параметра предоставляется брокером.</p> <h4 id="_5-1-2-5-password" tabindex="-1"><a href="#_5-1-2-5-password" class="header-anchor">#</a> 5.1.2.5. Password <div class="anchor-container" data-v-72af3cd3><span id="password" data-v-72af3cd3></span></div></h4> <p>Пароль для данного FIX-подключения. Если не меняли, то используйте стандартный, указанный в поле для ввода.</p> <p>Важно: при создании нового подключения, если пароль не удовлетворяет определенным критериям, робот может автоматически сменить пароль. Информацию о смене пароля можно найти в логе робота.
Текущий пароль подключения находится в “дереве” по адресу: ID: XX -&gt; Connections -&gt; astsxxxx_send_XXXX -&gt; Params.</p> <p>Для транзакционных подключений Московской биржи робот автоматически меняет пароль не чаще, чем один раз в месяц. Уведомление о смене пароля можно найти в логе робота.</p> <h4 id="_5-1-2-6-trading-account-s" tabindex="-1"><a href="#_5-1-2-6-trading-account-s" class="header-anchor">#</a> 5.1.2.6. Trading account(s) <div class="anchor-container" data-v-72af3cd3><span id="trading-account(s)" data-v-72af3cd3></span></div></h4> <p>Торговый счёт, предоставляется брокером, так же можно посмотреть в терминале.</p> <p><img src="/bot-doc/assets/img/5-1-2-6.bff04b45.png" alt="Alt"></p> <h4 id="_5-1-2-7-round-robin" tabindex="-1"><a href="#_5-1-2-7-round-robin" class="header-anchor">#</a> 5.1.2.7. Round robin <div class="anchor-container" data-v-72af3cd3><span id="round-robin" data-v-72af3cd3></span></div></h4> <p>Включение и выключение режима <code>Round robin</code> для данного подключения.
Подробнее о Round robin - <a href="/bot-doc/docs/05-params-description.html#s.client-code">здесь</a>.</p> <h4 id="_5-1-2-8-client-code" tabindex="-1"><a href="#_5-1-2-8-client-code" class="header-anchor">#</a> 5.1.2.8. Client code <div class="anchor-container" data-v-72af3cd3><span id="client-code" data-v-72af3cd3></span></div></h4> <p>Код клиента можно посмотреть в привязанном к счёту терминале (нажать F7 и открыть таблицу &quot;Позиции по деньгам&quot;) или запросить у брокера.</p> <p><img src="/bot-doc/assets/img/5-1-2-8.af388a7e.png" alt="Alt"></p> <h4 id="_5-1-2-9-firm-level-account" tabindex="-1"><a href="#_5-1-2-9-firm-level-account" class="header-anchor">#</a> 5.1.2.9. Firm level account <div class="anchor-container" data-v-72af3cd3><span id="firm-level-account" data-v-72af3cd3></span></div></h4> <p>Указание на то, что аккаунт является аккаунтом уровня фирмы. Неверное задание данного параметра приводит к ошибкам снятия и переставления заявок.</p> <h4 id="_5-1-2-10-number-of-movable-orders" tabindex="-1"><a href="#_5-1-2-10-number-of-movable-orders" class="header-anchor">#</a> 5.1.2.10. Number of movable orders <div class="anchor-container" data-v-72af3cd3><span id="number-of-movable-orders" data-v-72af3cd3></span></div></h4> <p>Количество заявок, которые робот будет держать по краям стакана, чтобы при необходимости использовать для переставлений. Этот параметр задает количество заявок на инструмент. В случае, если все заявки в данный момент использованы, то робот будет бросать по алгоритму <a href="/bot-doc/docs/05-params-description.html#s.client_code">Round robin</a>.</p> <h4 id="_5-1-2-11-min-steps-to-pull" tabindex="-1"><a href="#_5-1-2-11-min-steps-to-pull" class="header-anchor">#</a> 5.1.2.11. Min steps to pull <div class="anchor-container" data-v-72af3cd3><span id="min-steps-to-pull" data-v-72af3cd3></span></div></h4> <p>Отступ от цен, на которых стоят заявки для перемещения по краям стакана, при достижении которого лучшей ценой, эти заявки снимаются чтобы избежать их исполнения. Если все же они исполнятся, то сделки по ним не будут учтены в алгоритме, и произойдет расхождение позиции в роботе и на бирже.</p> <h4 id="_5-1-2-12-bind-ip" tabindex="-1"><a href="#_5-1-2-12-bind-ip" class="header-anchor">#</a> 5.1.2.12. Bind IP <div class="anchor-container" data-v-72af3cd3><span id="bind-ip" data-v-72af3cd3></span></div></h4> <p>IP-адрес, с которого будет проходить подключение к бирже. IP должен быть указан в договоре. Если не указан, то обратитесь в поддержку.</p> <h3 id="_5-1-3-санкт-петербургская-биржа" tabindex="-1"><a href="#_5-1-3-санкт-петербургская-биржа" class="header-anchor">#</a> 5.1.3. Санкт-Петербургская биржа <div class="anchor-container" data-v-72af3cd3><span id="санкт-петербургская-биржа" data-v-72af3cd3></span></div></h3> <h4 id="_5-1-3-1-name" tabindex="-1"><a href="#_5-1-3-1-name" class="header-anchor">#</a> 5.1.3.1. Name <div class="anchor-container" data-v-72af3cd3><span id="name" data-v-72af3cd3></span></div></h4> <p>Поле для задания имени подключения. Это значение пользователь задаёт для своего удобства, чтобы потом в списке транзакционных подключений ему было проще ориентироваться. Разрешенные символы: <code>_ a-z A-Z 0-9</code></p> <h4 id="_5-1-3-2-server" tabindex="-1"><a href="#_5-1-3-2-server" class="header-anchor">#</a> 5.1.3.2. Server <div class="anchor-container" data-v-72af3cd3><span id="server" data-v-72af3cd3></span></div></h4> <p>Адреса для подключения к серверу биржи.</p> <h4 id="_5-1-3-3-login" tabindex="-1"><a href="#_5-1-3-3-login" class="header-anchor">#</a> 5.1.3.3. Login <div class="anchor-container" data-v-72af3cd3><span id="login" data-v-72af3cd3></span></div></h4> <p>Логин для доступа к бирже, берется из договора с биржей.</p> <h4 id="_5-1-3-4-password" tabindex="-1"><a href="#_5-1-3-4-password" class="header-anchor">#</a> 5.1.3.4. Password <div class="anchor-container" data-v-72af3cd3><span id="password" data-v-72af3cd3></span></div></h4> <p>Пароль для доступа к бирже, берется из договора с биржей.</p> <h4 id="_5-1-3-5-memder-id" tabindex="-1"><a href="#_5-1-3-5-memder-id" class="header-anchor">#</a> 5.1.3.5. Memder ID <div class="anchor-container" data-v-72af3cd3><span id="memder-id" data-v-72af3cd3></span></div></h4> <p>Идентификатор участника торгов, берется из договора с биржей.</p> <h4 id="_5-1-3-6-trading-account-s" tabindex="-1"><a href="#_5-1-3-6-trading-account-s" class="header-anchor">#</a> 5.1.3.6. Trading account(s) <div class="anchor-container" data-v-72af3cd3><span id="trading-account(s)" data-v-72af3cd3></span></div></h4> <p>Идентификатор торгово-клирингового счёта участника, берется у брокера. Можете добавить несколько через запятую.</p> <h4 id="_5-1-3-7-client-id" tabindex="-1"><a href="#_5-1-3-7-client-id" class="header-anchor">#</a> 5.1.3.7. Client ID <div class="anchor-container" data-v-72af3cd3><span id="client-id" data-v-72af3cd3></span></div></h4> <p>Идентификатор клиентского кода, берется из договора с биржей.</p> <h4 id="_5-1-3-8-bind-ip" tabindex="-1"><a href="#_5-1-3-8-bind-ip" class="header-anchor">#</a> 5.1.3.8. Bind IP <div class="anchor-container" data-v-72af3cd3><span id="bind-ip" data-v-72af3cd3></span></div></h4> <p>IP-адрес, с которого будет проходить подключение к бирже. IP должен быть указан в договоре. Если не указан, то обратитесь в поддержку.</p> <h3 id="_5-1-4-alor-open-api" tabindex="-1"><a href="#_5-1-4-alor-open-api" class="header-anchor">#</a> 5.1.4. Alor Open API <div class="anchor-container" data-v-72af3cd3><span id="alor-open-api" data-v-72af3cd3></span></div></h3> <h4 id="_5-1-4-1-exchange" tabindex="-1"><a href="#_5-1-4-1-exchange" class="header-anchor">#</a> 5.1.4.1. Exchange <div class="anchor-container" data-v-72af3cd3><span id="exchange" data-v-72af3cd3></span></div></h4> <p>ALORMOEX или ALORSPB</p> <h4 id="_5-1-4-2-name" tabindex="-1"><a href="#_5-1-4-2-name" class="header-anchor">#</a> 5.1.4.2. Name <div class="anchor-container" data-v-72af3cd3><span id="name" data-v-72af3cd3></span></div></h4> <p>Поле для задания имени подключения. Это значение задается для удобства, чтобы потом в списке транзакционных подключений было проще ориентироваться. Разрешенные символы: <code>_ a-z A-Z 0-9</code></p> <h4 id="_5-1-4-3-conn-type" tabindex="-1"><a href="#_5-1-4-3-conn-type" class="header-anchor">#</a> 5.1.4.3. Conn type <div class="anchor-container" data-v-72af3cd3><span id="conn-type" data-v-72af3cd3></span></div></h4> <p>Тип подключения Mainnet или Testnet (боевой или тестовый соответственно)</p> <h4 id="_5-1-4-4-refresh-token" tabindex="-1"><a href="#_5-1-4-4-refresh-token" class="header-anchor">#</a> 5.1.4.4. Refresh token <div class="anchor-container" data-v-72af3cd3><span id="refresh-token" data-v-72af3cd3></span></div></h4> <p>Токен для доступа к API. Для заполнения поля необходимо перейти на портал разработчика Алор и стать клиентом для получения доступа. Пройти авторизацию и перейти в раздел &quot;Токены для доступа к API&quot;. Связать аккаунт разработчика с торговым счетом. Выписать токен. Скопировать сгенерившееся значение токена в поле <code>refresh token</code>.</p> <h4 id="_5-1-4-5-trading-account-s" tabindex="-1"><a href="#_5-1-4-5-trading-account-s" class="header-anchor">#</a> 5.1.4.5. Trading account(s) <div class="anchor-container" data-v-72af3cd3><span id="trading-account(s)" data-v-72af3cd3></span></div></h4> <p>Торговый счет клиента. Его можно посмотреть в личном кабинете брокера Алор. Если счетов несколько, то они указываются через запятую. Тоговые счета имеют следующий вид:</p> <p>Фондовый рынок: D1234</p> <p>Валютный рынок: G00012</p> <p>Срочный рынок: 7500123</p> <p>Видео, наглядно объясняющее, как подключить Alor Open API</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/5u4g8onxla0?si=HlqFBRebxi_fqTH7" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h3 id="_5-1-5-криптовалютные-биржи" tabindex="-1"><a href="#_5-1-5-криптовалютные-биржи" class="header-anchor">#</a> 5.1.5. Криптовалютные биржи <div class="anchor-container" data-v-72af3cd3><span id="криптовалютные-биржи" data-v-72af3cd3></span></div></h3> <p>На большинстве криптовалютных бирж для подключения достаточно одной или нескольких пар ключей (API Keys). Пара ключей - это публичный и секретный ключи. На разных биржах они могут называться немного по-разному. Сгенерировать пару ключей обычно можно самостоятельно на сайте биржи. Раздел управления ключами чаще всего можно найти в Настройки - Безопасность - API. На некоторых биржах у пар ключей есть понятие разрешений/привилегий, при создании ключей не забывайте указывать ключам разрешение на выполнение торговых операций.</p> <h4 id="_5-1-5-1-name" tabindex="-1"><a href="#_5-1-5-1-name" class="header-anchor">#</a> 5.1.5.1. Name <div class="anchor-container" data-v-72af3cd3><span id="name" data-v-72af3cd3></span></div></h4> <p>Поле для задания имени подключения. Это значение пользователь задаёт для своего удобства, чтобы потом в списке подключений ему было проще ориентироваться.</p> <h4 id="_5-1-5-2-api-key-api-id-access-key-public-key-key" tabindex="-1"><a href="#_5-1-5-2-api-key-api-id-access-key-public-key-key" class="header-anchor">#</a> 5.1.5.2. API Key/API/ID/Access Key/Public Key/Key <div class="anchor-container" data-v-72af3cd3><span id="api-key/api/id/access-key/public-key/key" data-v-72af3cd3></span></div></h4> <p>Публичный API-ключ для доступа к бирже, берется на бирже. Находится чаще всего в Настройки - Безопасность - API.</p> <h4 id="_5-1-5-3-api-key-secret-secret-access-secret-private-key-secret-key" tabindex="-1"><a href="#_5-1-5-3-api-key-secret-secret-access-secret-private-key-secret-key" class="header-anchor">#</a> 5.1.5.3. API key secret/Secret/Access Secret/Private Key/Secret Key <div class="anchor-container" data-v-72af3cd3><span id="api-key-secret/secret/access-secret/private-key/secret-key" data-v-72af3cd3></span></div></h4> <p>Секретный API-ключ для доступа к бирже, берется на бирже. Находится чаще всего в Настройки - Безопасность - API.</p> <h4 id="_5-1-5-4-bind-ip" tabindex="-1"><a href="#_5-1-5-4-bind-ip" class="header-anchor">#</a> 5.1.5.4. Bind IP <div class="anchor-container" data-v-72af3cd3><span id="bind-ip" data-v-72af3cd3></span></div></h4> <p>IP-адрес, с которого будет проходить подключение к бирже. Можете оставить Automatic или, при необходимости, установите определенный IP для подключения.</p> <h4 id="_5-1-5-5-margin-account" tabindex="-1"><a href="#_5-1-5-5-margin-account" class="header-anchor">#</a> 5.1.5.5. Margin account <div class="anchor-container" data-v-72af3cd3><span id="margin-account" data-v-72af3cd3></span></div></h4> <p>Указатель на то, что ваш аккаунт является маржинальным. Применяется не на всех криптобиржах.</p> <h4 id="_5-1-5-6-passphrase" tabindex="-1"><a href="#_5-1-5-6-passphrase" class="header-anchor">#</a> 5.1.5.6. Passphrase <div class="anchor-container" data-v-72af3cd3><span id="passphrase" data-v-72af3cd3></span></div></h4> <p>Фраза-пароль для доступа к бирже, применяется только для Kukoin.</p> <h4 id="_5-1-5-7-flood-timeout" tabindex="-1"><a href="#_5-1-5-7-flood-timeout" class="header-anchor">#</a> 5.1.5.7. Flood timeout <div class="anchor-container" data-v-72af3cd3><span id="flood-timeout" data-v-72af3cd3></span></div></h4> <p>В данном параметре указывается время, которое мы будем выжидать и не выставлять заявки после получения ошибки REASON_FLOOD (только для биржи Cex.io).</p> <h4 id="_5-1-5-8-user-id" tabindex="-1"><a href="#_5-1-5-8-user-id" class="header-anchor">#</a> 5.1.5.8. User ID <div class="anchor-container" data-v-72af3cd3><span id="user-id" data-v-72af3cd3></span></div></h4> <p>Это ID пользователя (только для биржи Cex.io).</p> <h4 id="_5-1-5-9-cod" tabindex="-1"><a href="#_5-1-5-9-cod" class="header-anchor">#</a> 5.1.5.9. COD <div class="anchor-container" data-v-72af3cd3><span id="cod" data-v-72af3cd3></span></div></h4> <p>Cancel on disconnect - включить механизм снятия заявок при разрыве связи (только для биржи Cex.io).</p> <h4 id="_5-1-5-10-create-fast-data-connection" tabindex="-1"><a href="#_5-1-5-10-create-fast-data-connection" class="header-anchor">#</a> 5.1.5.10. Create fast data connection <div class="anchor-container" data-v-72af3cd3><span id="create-fast-data-connection" data-v-72af3cd3></span></div></h4> <p>Поставьте данный флаг, если хотите создать быстрое маркетдата подключение с той же парой ключей (только для биржи Deribit).</p> <h4 id="_5-1-5-11-subaccount" tabindex="-1"><a href="#_5-1-5-11-subaccount" class="header-anchor">#</a> 5.1.5.11. Subaccount <div class="anchor-container" data-v-72af3cd3><span id="subaccount" data-v-72af3cd3></span></div></h4> <p>В данном поле указывается имя субаккаунта. Если суббакаунты не используются, то поле нужно оставить пустым.</p> <h4 id="_5-1-5-12-single-adding-order" tabindex="-1"><a href="#_5-1-5-12-single-adding-order" class="header-anchor">#</a> 5.1.5.12. Single ADDING order <div class="anchor-container" data-v-72af3cd3><span id="single-adding-order" data-v-72af3cd3></span></div></h4> <p>Для каждой бумаги разрешить только одну заявку в статусе ADDING, при попытке выставления еще одной заявки возвращать ошибку выставления. (Только для биржи Cex.io).</p> <h2 id="_5-2-параметры-портфеля" tabindex="-1"><a href="#_5-2-параметры-портфеля" class="header-anchor">#</a> 5.2. Параметры портфеля  <div class="anchor-container" data-v-72af3cd3><span id="параметры-портфеля" data-v-72af3cd3></span></div></h2> <p>Далее дано описание параметров портфеля. Все параметры являются редактируемыми, если прямо не указано иное. Описания некоторых параметров портфеля объединены в группы для удобства восприятия.</p> <h3 id="_5-2-1-name" tabindex="-1"><a href="#_5-2-1-name" class="header-anchor">#</a> 5.2.1. Name <div class="anchor-container" data-v-72af3cd3><span id="p.name" data-v-72af3cd3></span><span id="name" data-v-72af3cd3></span></div></h3> <p>Имя портфеля. В данном поле можно использовать латинские буквы и цифры, максимум 30 символов. У существующего портфеля имя не редактируется. Для изменения имени можете выключить торговлю, склонировать портфель, задать желаемое имя у склонированного портфеля и удалить предыдущий портфель.</p> <h3 id="_5-2-2-re-sell-re-buy" tabindex="-1"><a href="#_5-2-2-re-sell-re-buy" class="header-anchor">#</a> 5.2.2. re_sell/re_buy <div class="anchor-container" data-v-72af3cd3><span id="p.re_sell" data-v-72af3cd3></span><span id="p.re_buy" data-v-72af3cd3></span><span id="re_sell/re_buy" data-v-72af3cd3></span></div></h3> <p>Разрешена продажа/покупка (при взведении флага включает робот на продажу/покупку).</p> <p><strong>Важно :</strong> при снятии галок <code>re_sell</code> и <code>re_buy</code> происходит сброс счетчика ошибок робота.</p> <h3 id="_5-2-3-type" tabindex="-1"><a href="#_5-2-3-type" class="header-anchor">#</a> 5.2.3. Type <div class="anchor-container" data-v-72af3cd3><span id="p.portfolio_type" data-v-72af3cd3></span><span id="type" data-v-72af3cd3></span></div></h3> <p>Тип торгового алгоритма портфеля:</p> <ul><li><p><code>Arbitrage</code> - обычная арбитражная торговля с использованием всех заданных параметров. Сначала выставляется заявка по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту, при её сведении в сделку выставляются заявки по остальным инструментам портфеля.</p></li> <li><p><code>Option hedge</code> - арбитражная торговля с использованием опционов и автоматическим подсчетом <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> для обеих ног. Предполагается, что торговля будет вестить парой опцион и базовый актив. У такой пары главная нога это опцион и <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> опциона вычисляется автоматически с использованием модели Блека-Шоулза таким образом, чтобы delta у <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> опциона равнялась единице. <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> второй ноги задается автоматически всегда единицей.
Пример: (если дельта 1 лота опциона равна 0.5, то для первой ноги (опцион) count = 2, для второй ноги (базовый актив) count = 1 )</p></li> <li><p><code>TP algo</code> - режим работы с выставлением &quot;take profit&quot; заявки по главному инструменту. По главному инструменту держится только одна TP заявка, после прохождения не TP заявок в сделку, заявка TP снимается и выставляется новым объёмом. Заявки по второй ноге при этом не выставляются.</p></li> <li><p><code>TP algo 2</code> - режим работы с выставлением &quot;take profit&quot; заявки по главному инструменту. После каждой сделки по не TP заявке, выставляется новая TP заявка. У выставленной заявки есть <a href="/bot-doc/docs/05-params-description.html#s.timer">Timer</a> и <a href="/bot-doc/docs/05-params-description.html#s.sl">SL</a>. Заявки по второй ноге выставляются так же, как и в режиме <code>Arbitrage</code>.</p></li></ul> <p><strong>Важно:</strong> Если включен <a href="/bot-doc/docs/05-params-description.html#p.hedge_after">Hedge (sec)</a>, то каждые <a href="/bot-doc/docs/05-params-description.html#p.hedge_after">Hedge (sec)</a> секунд если позиция по главному инструменту портфеля ненулевая и нет выставляющихся или стоящих заявок, сводящих эту позицию к нулю, будет выставляться заявка, сводящая позицию к нулю; описанное выше распространяется и на позиции, открытые кликером; закрытие по <a href="/bot-doc/docs/05-params-description.html#p.hedge_after">Hedge (sec)</a> возможно только после того, как были сделки по главной бумаге по алгоритму (не по кликеру). Пока сделок не было, нет цен от которых откладывать тейк.</p> <h3 id="_5-2-4-type-trade" tabindex="-1"><a href="#_5-2-4-type-trade" class="header-anchor">#</a> 5.2.4. Type trade <div class="anchor-container" data-v-72af3cd3><span id="p.type_trade" data-v-72af3cd3></span><span id="type-trade" data-v-72af3cd3></span></div></h3> <p>Тип торговли, используется при расчете цен <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell/Buy</a>, <a href="/bot-doc/docs/05-params-description.html#p.price_s">Price_s/Price_b</a>:</p> <ul><li><p><code>Price</code> - режим торговли с использованием цен инструментов (bid и offer).</p></li> <li><p>IV - режим торговли волатильностью (implied volatility) вычисленной по ценам инструментов с использованием модели Блека-Шоулза.</p></li></ul> <h3 id="_5-2-5-type-price" tabindex="-1"><a href="#_5-2-5-type-price" class="header-anchor">#</a> 5.2.5. Type price <div class="anchor-container" data-v-72af3cd3><span id="p.price_type" data-v-72af3cd3></span><span id="type-price" data-v-72af3cd3></span></div></h3> <p>Тип определения цены инструмента:</p> <ul><li><p><code>Bid/offer</code>- использовать лучшую цену на покупку и лучшую цену на продажу.</p></li> <li><p><code>Orderbook</code> - параметр позволяет искать цену в стакане, таким образом, чтобы набрать необходимый объем. Цены на покупку и продажу набираются среди цен в стакане, начиная от лучшей цены в нужном направлении и далее в глубине стакана. Поиск необходимого объема происходит с помощью данной формулы:</p></li></ul> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>×</mo><mi>P</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mspace width="0.5em"></mspace><mi>o</mi><mi>f</mi><mspace width="0.5em"></mspace><mi>q</mi><mi>u</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>×</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn><mo>×</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>v</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext></mtext></mtext><mspace width="0.5em"></mspace><mi>o</mi><mi>p</mi><mi>e</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>p</mi><mi>o</mi><mi>s</mi><mi>e</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>v</mi><mi mathvariant="normal">_</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext></mtext></mtext><mspace width="0.5em"></mspace><mi>c</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>e</mi><mspace width="0.5em"></mspace><mi>p</mi><mi>o</mi><mi>s</mi><mi>e</mi></mrow></mtd></mtr></mtable></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Count \times Percent\enspace of\enspace quantity \times 0.01 \times 
\begin{cases} 
v\_in\_left, &amp;\text{if } \enspace open\enspace pose\\
v\_out\_left, &amp;\text{if } \enspace close\enspace pose 
\end{cases},</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord mathit">t</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit">t</span><span class="mord mspace enspace"></span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mspace enspace"></span><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mord mathit">u</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">×</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">1</span><span class="mbin">×</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">t</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">t</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">t</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace"></span></span><span class="mord mspace enspace"></span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">e</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace"></span></span><span class="mord mspace enspace"></span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mspace enspace"></span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span></p> <ul><li><code>Orderbook+filter</code> - аналогично Orderbook, но вычитать из набираемого объема цены своих заявок (если на соответствующих ценах присутствуют свои заявки).</li></ul> <p>Глубина стакана определяется значением параметра инструмента портфеля  <a href="/bot-doc/docs/05-params-description.html#s.depth_ob">Depth OB</a>.</p> <h3 id="_5-2-6-quote" tabindex="-1"><a href="#_5-2-6-quote" class="header-anchor">#</a> 5.2.6. Quote <div class="anchor-container" data-v-72af3cd3><span id="p.quote" data-v-72af3cd3></span><span id="quote" data-v-72af3cd3></span></div></h3> <p>Параметр позволяет котировать инструмент. Если включен, то заявка всегда держится в стакане, если выключено, то заявка на продажу выставляется когда <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a> ≥ <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a>
, а заявка на покупку выставляется когда <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a> ≤ <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a>.</p> <p>Видео объясняющее работу данного параметра:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/CfY5ZeS8aJM" title="Описание параметра Quote" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h3 id="_5-2-7-order-id" tabindex="-1"><a href="#_5-2-7-order-id" class="header-anchor">#</a> 5.2.7. Order ID <div class="anchor-container" data-v-72af3cd3><span id="p.portfolio_num" data-v-72af3cd3></span><span id="order-id" data-v-72af3cd3></span></div></h3> <p>Идентификатор всех заявок портфеля, так же определяет приоритет вызова торгового алгоритма портфеля.</p> <p><em>Пример</em>:<br>
Пусть есть несколько портфелей и во всех этих портфелях есть один и тот же инструмент. При изменении цены или объема лучшей цены на покупку или продажу по данному инструменту вызывается алгоритм торговли по всем портфелям, в которых этот инструмент присутствует. Торговый алгоритм портфелей будет вызываться в порядке возрастания Order ID, т.е. самым первым вызовется торговый алгоритм портфеля с Order ID = a, а самым последним с Order ID = z. При совпадении Order ID у разных портфелей порядок вызова торгового алгоритма портфелей НЕ определен и будет произвольным.</p> <h3 id="_5-2-8-hedge-sec" tabindex="-1"><a href="#_5-2-8-hedge-sec" class="header-anchor">#</a> 5.2.8. Hedge (sec) <div class="anchor-container" data-v-72af3cd3><span id="p.hedge_after" data-v-72af3cd3></span><span id="hedge-(sec)" data-v-72af3cd3></span></div></h3> <p>Интервал времени в секундах по прошествии которого автоматически хеджировать незахеджированную позицию в случаях, когда заявка по второй ноге не выставилась по алгоритму (случаи связанные с техническими проблемами на самой бирже, ограничениями по рейтлимиту и другими не рыночными ситуациями). Если задать значение &quot;-1&quot;, то проверка по таймеру на незахеджированность не осуществляется.</p> <p><strong>Неочевидный момент:</strong><br>
Если позиция, с учетом прохождения текущих активных заявок, расходится больше чем на значение <a href="/bot-doc/docs/05-params-description.html#p.overlay">Overlay</a> (активные заявки могут быть), то подравняется позиция не трогая текущих активных заявок. Если подравнивающая заявка выставилась, то скинется счетчик ошибок для данной бумаги. Расхождение считается отдельно для каждого из инструментов второй ноги. Выравнивание также осуществляется по каждому из инструментов второй ноги отдельно. В один момент времени на каждом из инструментов второй ноги может висеть не более одной выравнивающей заявки. Выравнивающая заявка, в случае если она не прошла в сделку, переставляется раз в секунду.</p> <h3 id="_5-2-9-only-maker" tabindex="-1"><a href="#_5-2-9-only-maker" class="header-anchor">#</a> 5.2.9. Only maker <div class="anchor-container" data-v-72af3cd3><span id="p.maker" data-v-72af3cd3></span><span id="only-maker" data-v-72af3cd3></span></div></h3> <p>Выставлять котирующие (т.е. при включенном режиме <a href="/bot-doc/docs/05-params-description.html#p.quote">Quote</a>) заявки по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге с признаком &quot;снять если заявка будет taker&quot; (при условии что биржей поддерживается работа этого типа заявки).</p> <p><strong>Важно:</strong> Если вы используете данный параметр, то вероятнее всего вам понадобится взвести флаг <a href="/bot-doc/docs/05-params-description.html#p.simply_first">Simply first</a>. Для избежания избыточного числа неэффективных заявок (в случаях когда заявка ставится и отклоняется т.к. попадает на встречную), что в итоге может привести к санкциям со стороны биржи.</p> <h3 id="_5-2-10-simply-first" tabindex="-1"><a href="#_5-2-10-simply-first" class="header-anchor">#</a> 5.2.10. Simply first <div class="anchor-container" data-v-72af3cd3><span id="p.simply_first" data-v-72af3cd3></span><span id="simply-first" data-v-72af3cd3></span></div></h3> <p>Если параметр включен, то когда цены <a href="/bot-doc/docs/05-params-description.html#p.price_s">Price_s/Price_b</a> попадают в широкий спред или на противоположную сторону стакана, то они всегда будут выставляться не глубже, чем на один шаг цены в спред:</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mi>max</mi><mrow><mo fence="true">(</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><msub><mi>s</mi><mn>0</mn></msub><mo separator="true">,</mo><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>r</mi><mo>−</mo><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Price\_s_1=\max\left(Price\_s_0,offer-step\right),</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.85em;"></span><span class="strut bottom" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop">max</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">−</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mpunct">,</span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><msub><mi>b</mi><mn>1</mn></msub><mo>=</mo><mi>min</mi><mrow><mo fence="true">(</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><msub><mi>b</mi><mn>0</mn></msub><mo separator="true">,</mo><mi>b</mi><mi>i</mi><mi>d</mi><mo>+</mo><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Price\_b_1=\min\left(Price\_b_0,bid+step\right),</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.85em;"></span><span class="strut bottom" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop">min</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord mathit">d</span><span class="mbin">+</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mpunct">,</span></span></span></span></p> <p>где <code>bid</code>, <code>offer</code>, <code>step</code> - это бид, оффер и шаг цены по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге, нижний индекс &quot;0&quot; означает текущее значение параметра, нижний индекс &quot;1&quot; означает новое значение параметра.<br>
Если у <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаги взведен флаг <code>Maker</code> и текущий спред в стакане равен одному шагу цены, то заявка на продажу будет выставлена по цене <code>offer</code>, а на покупку по цене <code>bid</code> (в противном случае заявка просто не смогла бы выставиться и &quot;спамила&quot; бы биржу).</p> <p><strong>Важно:</strong> если наша заявка является бидом или оффером и при этом является единственной заявкой на данном ценовом уровне, то в качестве бида и оффера в предыдущей формуле используются бид и оффер без учета нашей заявки в стакане.</p> <h3 id="_5-2-11-equal-prices" tabindex="-1"><a href="#_5-2-11-equal-prices" class="header-anchor">#</a> 5.2.11. Equal prices <div class="anchor-container" data-v-72af3cd3><span id="p.equal_prices" data-v-72af3cd3></span><span id="equal-prices" data-v-72af3cd3></span></div></h3> <p>Если галка не стоит, то цена второй ноги определяется исходя из цен, которые были на момент сигнала на выставление заявки по <code>is first</code> инструменту. Если галка стоит, то заявка по второй ноге будет выставлена по такой цене, чтобы <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a> = <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a> и <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a> = <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> (работает только для портфелей с двумя бумагами).<br>
Таким образом цены в заявках будут строго соответствовать <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a>, даже если в моменте были лучшие цены.
Включение параметра способствует меньшему числу проскальзываний по второй ноге, но и уменьшает количество положительных проскальзываний (когда купили по цене лучшей, чем хотели).</p> <p><em>Пример</em>: в первой ноге стоит цена 100, в второй цена 95. Мы хотим купить в первой ноге по 100, если в второй тоже будет цена сто, т.е. раздвижка будет ноль. В моменте во второй ноге резко рынок дергается вверх и достигает 110.
Если галка стоит, то мы купим первую ногу по сто, и попытаемся продать вторую по 100 (т.к. нас устраивала раздвижка ноль).
Если галка НЕ стоит, то мы кинем на цену которые дали сигнал к сделке , т.е. первую также купим по сто, вторую попытаемся продать по 110.</p> <p>Формула для цены второй ноги для покупки:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo>=</mo><mo>±</mo><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>l</mi><mo>−</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">/</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Price=\pm\left(Lim\_sell-Price\_s
\begin{cases}+,&amp; Ratio\_sign_1=+\\
        \times,&amp; Ratio\_sign_1=\times\end{cases}
ratio_1\right)
\begin{cases}-,&amp; Ratio\_sign_2=+\\
        /,&amp; Ratio\_sign_2=\times\end{cases}
ratio_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mrel">=</span><span class="mord">±</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">/</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p>для продажи:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo>=</mo><mo>±</mo><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>u</mi><mi>y</mi><mo>−</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>b</mi><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">/</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Price=\pm\left(Lim\_buy-Price\_b
\begin{cases}+,&amp; Ratio\_sign_1=+\\
        \times,&amp; Ratio\_sign_1=\times\end{cases}
ratio_1\right)
\begin{cases}-,&amp; Ratio\_sign_2=+\\
        /,&amp; Ratio\_sign_2=\times\end{cases}
ratio_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mrel">=</span><span class="mord">±</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">b</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">/</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p>Знак ± - зависит от того, какое выставлено значение параметра <a href="/bot-doc/docs/05-params-description.html#s.on_buy">On_buy</a> на 2-й ноге (если  Buy, то &quot;+&quot;, если  Sell, то &quot;-&quot;).</p> <h3 id="_5-2-12-volumes" tabindex="-1"><a href="#_5-2-12-volumes" class="header-anchor">#</a> 5.2.12. Volumes <div class="anchor-container" data-v-72af3cd3><span id="p._volumes" data-v-72af3cd3></span><span id="volumes" data-v-72af3cd3></span></div></h3> <p>Группа параметров отвечающих за объем выставляемых заявок. Группу можно разделить на две пары параметров: <a href="/bot-doc/docs/05-params-description.html#p.v_in_l">v_in_left/v_in_right</a> и <a href="/bot-doc/docs/05-params-description.html#p.v_out_l">v_out_left/v_out_right</a>, а так же параметры <a href="/bot-doc/docs/05-params-description.html#p.virtual_0_pos">Virt_0_pos</a> и <a href="/bot-doc/docs/05-params-description.html#p.n_perc_fill">n_perc_fill</a>.</p> <h4 id="_5-2-12-1-v-min-v-max" tabindex="-1"><a href="#_5-2-12-1-v-min-v-max" class="header-anchor">#</a> 5.2.12.1. v_min/v_max <div class="anchor-container" data-v-72af3cd3><span id="p.v_min" data-v-72af3cd3></span><span id="p.v_max" data-v-72af3cd3></span><span id="v_min/v_max" data-v-72af3cd3></span></div></h4> <p>Минимальная/максимальная разрешенная позиция по портфелю. Измеряется в штуках портфелей.</p> <h4 id="_5-2-12-2-v-in-left-v-in-right" tabindex="-1"><a href="#_5-2-12-2-v-in-left-v-in-right" class="header-anchor">#</a> 5.2.12.2. v_in_left/v_in_right <div class="anchor-container" data-v-72af3cd3><span id="p.v_in_l" data-v-72af3cd3></span><span id="p.v_in_r" data-v-72af3cd3></span><span id="v_in_left/v_in_right" data-v-72af3cd3></span></div></h4> <p>Отвечает за минимальный/максимальный разрешенный объем для однократного входа в позицию (в штуках портфелей);<br>
Если тип определения цены <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> выбран <code>Orderbook</code> или <code>Orderbook+filter</code> то в качестве объема для однократного входа в позицию <code>v_in_right</code> не используется.</p> <h4 id="_5-2-12-3-v-out-left-v-out-right" tabindex="-1"><a href="#_5-2-12-3-v-out-left-v-out-right" class="header-anchor">#</a> 5.2.12.3. v_out_left/v_out_right <div class="anchor-container" data-v-72af3cd3><span id="p.v_out_l" data-v-72af3cd3></span><span id="p.v_out_r" data-v-72af3cd3></span><span id="v_out_left/v_out_right" data-v-72af3cd3></span></div></h4> <p>Отвечает за минимальный/максимальный разрешенный объем для однократного выхода из позиции (в штуках портфелей);<br>
Если тип определения цены <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> выбран <code>Orderbook</code> или <code>Orderbook+filter</code> то в качестве объема для однократного выхода из позиции <code>v_out_right</code> не используется.</p> <h4 id="_5-2-12-4-virt-0-pos" tabindex="-1"><a href="#_5-2-12-4-virt-0-pos" class="header-anchor">#</a> 5.2.12.4. Virt 0 pos <div class="anchor-container" data-v-72af3cd3><span id="p.virtual_0_pos" data-v-72af3cd3></span><span id="virt-0-pos" data-v-72af3cd3></span></div></h4> <p>Параметр позволяет <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> заявке, выставленной по алгоритму, по бумаге с направлением в сторону закрытия позиции не только сводить позицию к нулю, но и сразу открывать новую позицию с противоположным направлением, кроме того объем заявки никогда не может быть меньше <a href="/bot-doc/docs/05-params-description.html#p.v_in_l">v_in_left</a> и <a href="/bot-doc/docs/05-params-description.html#p.v_out_l">v_out_left</a>.</p> <p><strong>Важно:</strong> если установлен флаг <a href="/bot-doc/docs/05-params-description.html#p.to0">To0</a>, то можно получить такое поведение робота, что позиция никогда не попадает ровно в 0, а все время переворачивается то в одну, то в другую сторону. При включенном параметре <code>Virt 0 pos</code> робот может не дойти до позиций <a href="/bot-doc/docs/05-params-description.html#p.v_min">v_min/v_max</a>, т.к. “упираемся” в <a href="/bot-doc/docs/05-params-description.html#p.v_in_l">v_in_left/v_in_right</a> и <a href="/bot-doc/docs/05-params-description.html#p.v_out_l">v_out_left/v_out_right</a> (робот не ставит меньше этих значений).</p> <h4 id="_5-2-12-5-n-perc-fill" tabindex="-1"><a href="#_5-2-12-5-n-perc-fill" class="header-anchor">#</a> 5.2.12.5. n_perc_fill <div class="anchor-container" data-v-72af3cd3><span id="p.n_perc_fill" data-v-72af3cd3></span><span id="n_perc_fill" data-v-72af3cd3></span></div></h4> <p>Параметр отвечает за связь позиции по главной бумаге и позиции по портфелю. Исходя из этого параметра осуществляется округление отношения позиции (<a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a>) по главному инструменту к параметру <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> того же инструмента. Значение <code>n_perc_fill</code> равное нулю отключает механизм округления, в результате позиция всегда округляется по модулю вниз. Во всех остальных случаях работают следующие правила:</p> <ul><li><p>если при изменении позиции по главному инструменту портфеля целая часть позиции не изменилась, а остаток от деления нацело <a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a> на <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> находится в диапазоне от <code>(100 - n_perc_fill)</code> до <code>n_perc_fill</code> процентов от <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a>, то позиция по портфелю не меняется, если остаток слева от диапазона, то округление идет по модулю вниз, если остаток справа от диапазона, то округление идет по модулю вверх. Параметр <code>n_perc_fill</code> может принимать значения только от 50 до 100;</p></li> <li><p>если при увеличении позиции целая часть от деления нацело <a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a> на <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> увеличилась, а модуль остатка от деления нацело <a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a> на <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> больше или равен <code>n_perc_fill</code> процентов от <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a>, то позицию по портфелю округляем по модулю вверх, иначе вниз;</p></li> <li><p>если при уменьшении позиции целая часть от деления нацело <a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a> на <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> уменьшилась, а модуль остатка от деления нацело <a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a> на <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> меньше или равен <code>(100 - n_perc_fill)</code> процентов от <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a>, то позицию по портфелю округляем по модулю вниз, иначе вверх.</p></li></ul> <h3 id="_5-2-13-delta" tabindex="-1"><a href="#_5-2-13-delta" class="header-anchor">#</a> 5.2.13. Delta <div class="anchor-container" data-v-72af3cd3><span id="p.delta" data-v-72af3cd3></span><span id="delta" data-v-72af3cd3></span></div></h3> <p>Минимальное отклонение <a href="/bot-doc/docs/05-params-description.html#p.price_s">Price_s</a> и `<a href="/bot-doc/docs/05-params-description.html#p.price_b">Price_b</a> от цены выставленной заявки на продажу или покупку, соответственно, при превышении которого робот может переставить котируемую заявку, то есть заявку по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту (используется только при включенном режиме <a href="/bot-doc/docs/05-params-description.html#p.quote">Quote</a>);</p> <p><em>Пример</em>:<br>
Delta = 10, выставлена котирующая заявка на продажу по цене 95 (т.е на момент выставления этой заявки Price_s = 95). Как только Price_s станет меньше 85 или больше 105, заявка переставится по новой цене</p> <h3 id="_5-2-14-first-delta" tabindex="-1"><a href="#_5-2-14-first-delta" class="header-anchor">#</a> 5.2.14. First delta <div class="anchor-container" data-v-72af3cd3><span id="p.first_delta" data-v-72af3cd3></span><span id="first-delta" data-v-72af3cd3></span></div></h3> <p>Задается в процентах (%), это один из параметров, который ведет к перевыставлению заявки с новым объемом если ее текущий не исполненный объем стал меньше, чем <code>First delta</code> процентов от первоначального выставленного объема (используется только при включенном режиме <a href="/bot-doc/docs/05-params-description.html#p.quote">Quote</a>). Таким образом можно поддерживать максимально необходимый объем в котируемой заявке.</p> <p><em>Пример</em>:<br>
First delta = 20. Вы котируете на продажу объёмом 100 и вашу заявку начинают выкупать по частям. Заявка висит до тех пор, пока её неисполненный объём больше или равен 20. Как только он становится меньше 20, заявка снимается и, если может, выставляется новая по цене <code>Price_s</code> в полном объёме.</p> <h3 id="_5-2-15-market-volume" tabindex="-1"><a href="#_5-2-15-market-volume" class="header-anchor">#</a> 5.2.15. Market volume <div class="anchor-container" data-v-72af3cd3><span id="p.mkt_volume" data-v-72af3cd3></span><span id="market-volume" data-v-72af3cd3></span></div></h3> <p>Данный параметр ограничивает выставление заявки по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту в случаях,
если в очереди в стакане перед предполагаемой ценой выставления уже есть объем больший чем указан в <code>Market volume</code>.</p> <p>Пример:</p> <p><strong>Важно:</strong> для отображения на сайте используется <code>lot_size</code>.</p> <h3 id="_5-2-16-price-check" tabindex="-1"><a href="#_5-2-16-price-check" class="header-anchor">#</a> 5.2.16. Price check <div class="anchor-container" data-v-72af3cd3><span id="p.price_check" data-v-72af3cd3></span><span id="price-check" data-v-72af3cd3></span></div></h3> <p>Если предполагаемая цена выставления заявки по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге попадает в стакан глубже, чем на <code>Price check</code> пунктов, то заявка не выставляется.
То есть, если <code>offer + Price check &lt; Price_s</code>, где <code>offer</code> – лучшая цена на продажу <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструмента, то заявка выставлена не будет.
Для покупки аналогично.</p> <h3 id="_5-2-17-max-not-hedged" tabindex="-1"><a href="#_5-2-17-max-not-hedged" class="header-anchor">#</a> 5.2.17. Max not hedged <div class="anchor-container" data-v-72af3cd3><span id="p.max_not_hedged" data-v-72af3cd3></span><span id="max-not-hedged" data-v-72af3cd3></span></div></h3> <p>Значение равное сумме допустимых незахеджированных открытий по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту (т.е. когда по любому из не <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструментов &quot;висит&quot; в рынке не менее, чем <code>Max not hedged</code> активных заявок) и ошибок выставления (все ошибки, кроме кроссов), после которой торговля по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту будет остановлена до тех пор пока хотя бы одна из незахеджированных позиций не захеджируется или не сбросится счетчик ошибок.</p> <p><strong>Важно:</strong> необходимо использовать параметр <code>Max not hedged</code> в связке с <a href="/bot-doc/docs/05-params-description.html#p.hedge_after">Hedge (sec)</a>, так как иначе при накоплении определенного количества ошибок произойдет остановка торговли.
Используя в портфеле инструменты некоторых площадок с типами инструментов &quot;купить/закрыть покупку&quot;, &quot;продать/закрыть продажу&quot; Max not hedged может иметь значение только &quot;1&quot;.</p> <h3 id="_5-2-18-overlay" tabindex="-1"><a href="#_5-2-18-overlay" class="header-anchor">#</a> 5.2.18. Overlay <div class="anchor-container" data-v-72af3cd3><span id="p.overlay" data-v-72af3cd3></span><span id="overlay" data-v-72af3cd3></span></div></h3> <p>Хеджировать только если разница (в портфелях) между <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумагой и остальными инструментами портфеля больше или равна значению данного параметра (в штуках портфелей, то есть в той же размерности, что и <a href="/bot-doc/docs/05-params-description.html#p.v_in_l">v_in_left/v_in_right</a>).</p> <h3 id="_5-2-19-lim-sell-lim-buy" tabindex="-1"><a href="#_5-2-19-lim-sell-lim-buy" class="header-anchor">#</a> 5.2.19. Lim_sell/Lim_buy <div class="anchor-container" data-v-72af3cd3><span id="p.lim_s" data-v-72af3cd3></span><span id="p.lim_b" data-v-72af3cd3></span><span id="lim_sell/lim_buy" data-v-72af3cd3></span></div></h3> <p><code>Lim_Sell</code> – сигнальная цена на продажу, заявка по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге выставляется если <code>Sell ≥ Lim_Sell</code> вне зависимости от того включен или нет режим <a href="/bot-doc/docs/05-params-description.html#p.quote">Quote</a>.</p> <p><code>Lim_Buy</code> – сигнальная цена на покупку, заявка по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге выставляется если <code>Buy ≤ Lim_Buy</code> вне зависимости от того включен или нет режим  <a href="/bot-doc/docs/05-params-description.html#p.quote">Quote</a>.</p> <p>Работа данных параметров наглядно продемонстрирована в этом видео:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/DxLdFeUU_bM" title="Описание параметра Lim-sell и Lim-buy" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h3 id="_5-2-20-threshold" tabindex="-1"><a href="#_5-2-20-threshold" class="header-anchor">#</a> 5.2.20. Threshold <div class="anchor-container" data-v-72af3cd3><span id="p.threshold" data-v-72af3cd3></span><span id="threshold" data-v-72af3cd3></span></div></h3> <p>Параметр будет использоваться в алгоритме, только если <code>Threshold &gt; 0</code>. Если <code>Sell ≥ Lim_Sell + Threshold</code> или <code>Buy ≤ Lim_Buy - Threshold</code>, то при сильном движении раздвижки на размер <code>Threshold</code> при расчете цен <a href="/bot-doc/docs/05-params-description.html#p.price_s">Price_s</a>, <a href="/bot-doc/docs/05-params-description.html#p.price_b">Price_b</a>, соответственно, параметр отключает <a href="/bot-doc/docs/05-params-description.html#p.simply_first">Simply first</a>, а при выставлении заявки по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге отключает <a href="/bot-doc/docs/05-params-description.html#p.maker">Only maker</a>. Под &quot;отключает&quot; имеется в виду &quot;не использует&quot;. Видимые пользователю настройки портфеля не будут изменены.</p> <p><strong>Важно:</strong> нельзя переставить заявку на бирже, изменяя флаг <a href="/bot-doc/docs/05-params-description.html#p.maker">Only maker</a> заявки, уже стоящей на этой бирже, поэтому при выполнении условий на <code>Threshold</code>, переставление всегда заменяется на отдельные снятие и выставление завки.</p> <h3 id="_5-2-21-trading-signal-shift" tabindex="-1"><a href="#_5-2-21-trading-signal-shift" class="header-anchor">#</a> 5.2.21. Trading signal shift <div class="anchor-container" data-v-72af3cd3><span id="p._limits_shift" data-v-72af3cd3></span><span id="trading-signal-shift" data-v-72af3cd3></span></div></h3> <p>Группа параметров, отвечающих за создание арбитражного канала.</p> <h4 id="_5-2-21-1-k" tabindex="-1"><a href="#_5-2-21-1-k" class="header-anchor">#</a> 5.2.21.1. K <div class="anchor-container" data-v-72af3cd3><span id="p.k" data-v-72af3cd3></span><span id="k" data-v-72af3cd3></span></div></h4> <p>Коэффициент сдвига заявки, что улучшает цену для каждого последующего входа.<br>
На параметр <code>К</code> будут сдвинуты заявки <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a> в случае продажи или <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> в случае покупки при наборе позиции. Другими словами, на сколько улучшится положение заявки после удара на вход (ударом считается сделка объемом не меньше <a href="/bot-doc/docs/05-params-description.html#p.v_in_l">v_in_left</a>).</p> <p>Видео объясняющее работу параметра <code>К</code>:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/2qUPvspTQq4" title="Описание параметра K" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h4 id="_5-2-21-2-тр" tabindex="-1"><a href="#_5-2-21-2-тр" class="header-anchor">#</a> 5.2.21.2. ТР <div class="anchor-container" data-v-72af3cd3><span id="p.tp" data-v-72af3cd3></span><span id="тр" data-v-72af3cd3></span></div></h4> <p>Уровень противоположной заявки после удара. С помощью параметра <code>ТР</code> вы указываете где будет выставлена противоположная заявка после удара (работает только после первого удара).
Если нас ударили по <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a> = 150, то при 'ТР' = 50, <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> будет выставлен на 150 – 50 = 100.</p> <p>Видео объясняющее работу параметра <code>ТР</code>:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/R2nuoUpGq9c" title="Описание параметра TP" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h4 id="_5-2-21-3-k1" tabindex="-1"><a href="#_5-2-21-3-k1" class="header-anchor">#</a> 5.2.21.3. K1 <div class="anchor-container" data-v-72af3cd3><span id="p.k1" data-v-72af3cd3></span><span id="k1" data-v-72af3cd3></span></div></h4> <p>Коэффициент указывает на сколько будет сдвинута противоположная заявка после второго удара.
<a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> = 100 из предыдущего примера, при <code>К1</code> = 5, будет установлена на 100 + 5 = 105, после второго удара по <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a>, после того как пройдет еще одна сделка, <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> будет увеличен еще на 5 и прмиет значение 110, после очередной сделки по <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a>, <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> примет значение 115 и т.д.</p> <p>Видео объясняющее работу параметра <code>К1</code>:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/nYSPQR2LFhE" title="Описание параметра K1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h4 id="_5-2-21-4-k2" tabindex="-1"><a href="#_5-2-21-4-k2" class="header-anchor">#</a> 5.2.21.4. K2 <div class="anchor-container" data-v-72af3cd3><span id="p.k2" data-v-72af3cd3></span><span id="k2" data-v-72af3cd3></span></div></h4> <p>Коэффициент сдвига заявки, что улучшает цену заявки каждого последующего выхода.
На параметр <code>К2</code> будут сдвинуты заявки <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a> или <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> в случае продажи или покупки, соответственно, при выходе из позиции. Другими словами, на сколько улучшится положение следующей заявки на выход после предыдущего удара (ударом считается сделка объемом не меньше <a href="/bot-doc/docs/05-params-description.html#p.v_out_l">v_out_left</a>).
Из примера ранее где <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> = 105 при <code>К2</code> = 3. При ударе по <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> его значение станет равным 105 - 3 = 102.</p> <p>Видео объясняющее работу параметра К2:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/9RbN893_eD0" title="Описание параметра K2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h3 id="_5-2-22-limits-timer" tabindex="-1"><a href="#_5-2-22-limits-timer" class="header-anchor">#</a> 5.2.22. Limits timer <div class="anchor-container" data-v-72af3cd3><span id="p.timer" data-v-72af3cd3></span><span id="limits-timer" data-v-72af3cd3></span></div></h3> <p>Время таймера (задается в секундах) по истечению которого происходит сдвиг обоих параметров <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a> и <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> на значение K. Таймер включается если торговля включена и проходит сигнал на покупку или продажу, но торговля запрещена из-за того, что робот уже набрал максимальную позицию (по <a href="/bot-doc/docs/05-params-description.html#p.v_min">v_min/v_max</a>). Таймер выключается при значении <a href="/bot-doc/docs/05-params-description.html#p.percent">Percent</a> &gt; 100%.</p> <p>Пример: значения <code>Limits timer</code> = 10 сек, <code>Percent</code> = 60. Возьмем временное окно 10 сек: допустим, сигнал был 2 сек, потом на 3 сек пропал, потом 4 сек был и снова на 1 сек пропал. За 10 сек сигнал был суммарно 6 сек, что больше или равно 60% от 10 сек, следовательно условие выполнено, сдвиг выполняется.</p> <h3 id="_5-2-23-percent" tabindex="-1"><a href="#_5-2-23-percent" class="header-anchor">#</a> 5.2.23. Percent <div class="anchor-container" data-v-72af3cd3><span id="p.percent" data-v-72af3cd3></span><span id="percent" data-v-72af3cd3></span></div></h3> <p>Процент от <a href="/bot-doc/docs/05-params-description.html#p.timer">Limits timer</a> после которого происходит сдвиг. Если сигнал на торговлю продержался указанный процент времени от значения <a href="/bot-doc/docs/05-params-description.html#p.timer">Limits timer</a>, то <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell/Lim_buy</a>) передвигаются на <a href="/bot-doc/docs/05-params-description.html#p.k">K</a>, не смотря на отсутствие сделок по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге.</p> <h3 id="_5-2-24-always-timer" tabindex="-1"><a href="#_5-2-24-always-timer" class="header-anchor">#</a> 5.2.24. Always timer <div class="anchor-container" data-v-72af3cd3><span id="p.always_limits_timer" data-v-72af3cd3></span><span id="always-timer" data-v-72af3cd3></span></div></h3> <p>Включенный <code>Always timer</code> позволяет всегда использовать <a href="/bot-doc/docs/05-params-description.html#p.timer">Limits timer</a>, даже когда позиция портфеля не достигла значений <code>v_min</code> или <code>v_max</code>. При выключенном <code>Always timer</code> смещение уровней <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_sell</a> и/или <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_buy</a> происходит только когда происходят сделки или когда позиция портфеля достигла значений <code>v_min</code> или <code>v_max</code>. Включение этого параметра позволяет двигать уровни, даже если сделка не совершилась, но робот только попытался выставить заявку.</p> <h3 id="_5-2-25-pos" tabindex="-1"><a href="#_5-2-25-pos" class="header-anchor">#</a> 5.2.25. Pos <div class="anchor-container" data-v-72af3cd3><span id="p.pos" data-v-72af3cd3></span><span id="pos" data-v-72af3cd3></span></div></h3> <p>Текущая позиция портфеля (в штуках портфелей), вычисляется по формуле:</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>o</mi><mi>s</mi><mo>=</mo><mo>[</mo><mfrac><mrow><mi>C</mi><mi>u</mi><mi>r</mi><mi>p</mi><mi>o</mi><msub><mi>s</mi><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow></mfrac><mo>]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Pos=[\frac{Curpos_{first}}{Count_{first}}],</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.9914109999999999em;"></span><span class="strut bottom" style="height:1.539491em;vertical-align:-0.5480799999999999em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mrel">=</span><span class="mopen">[</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.51308em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></p> <p>где Curpos<sub>first</sub> и Count<sub>first</sub> - это параметры <a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a> и <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> для инструмента портфеля с взведенным флагом <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a>, и округляется вверх или вниз в зависимости от значения параметра <a href="/bot-doc/docs/05-params-description.html#p.n_perc_fill">n_perc_fill</a>. Изменяется роботом, но может быть отредактирована пользователем вручную.</p> <h3 id="_5-2-26-timetable" tabindex="-1"><a href="#_5-2-26-timetable" class="header-anchor">#</a> 5.2.26. Timetable <div class="anchor-container" data-v-72af3cd3><span id="p.use_tt" data-v-72af3cd3></span><span id="p.trading_days" data-v-72af3cd3></span><span id="timetable" data-v-72af3cd3></span></div></h3> <p>Использовать торговлю по расписанию. Расписание состоит из списка дней недели (с понедельника по воскресенье, параметр <code>TradingDays</code>), из которых неодходимо выбрать те дни, в которые будет осуществляться торговля, и списка торговых периодов (периоды одни и те же для всех торговых дней), для каждого из периодов задаются свои параметры:</p> <p><code>Begin</code> - начало торгового периода.<br> <code>End</code> - окончание торгового периода.<br> <code>re_sell</code> - что делать с <a href="/bot-doc/docs/05-params-description.html#p.re_sell">re_sell</a> в течение данного интервала: всегда включать, всегда выключать, &quot;ручной&quot; режим.<br> <code>re_buy</code> - что делать с <a href="/bot-doc/docs/05-params-description.html#p.re_buy">re_buy</a> в течение данного интервала: всегда включать, всегда выключать, &quot;ручной&quot; режим.<br> <code>Close</code> - попытаться закрыть позицию сразу после окончания торгового периода (в течение 10 секунд).<br> <code>To market</code> - попытаться выровнить позицию сразу после окончания торгового периода (в течение 10 секунд).<br> <code>To0</code> - что делать с <a href="/bot-doc/docs/05-params-description.html#p.to0">To0</a> в течение данного интервала: всегда включать, всегда выключать, &quot;ручной&quot; режим.<br> <code>Save history</code> - сохранять ли историю изменения некоторых параметров портфеля в течение данного интервала.</p> <p>Если текущее локальное время на сервере (<code>curTime</code>) попадает в один из периодов, т.е. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>e</mi><mi>g</mi><mi>i</mi><msub><mi>n</mi><mi>i</mi></msub><mo>≤</mo><mi>c</mi><mi>u</mi><mi>r</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>≤</mo><mi>E</mi><mi>n</mi><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Begin_i \le curTime \le End_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">≤</span><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathit">e</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, то управления параметрами портфеля, описанными выше, переходит к расписанию, в противном случае (если текущее время не попадает ни в один из периодов) параметры портфеля, описанные выше, автоматически выключаются.</p> <p>&quot;Ручной&quot; режим означает, что данный параметр портфеля на данном временном интервале НЕ контролируется расписанием, т.е. пользователь может изменять значения данного параметра &quot;руками&quot; даже при включенном расписании.</p> <p>Расписание торговых дней недели можно также установить сразу для нескольких портфелей, выделив их в виджете <code>Portfolios</code> и выбрав пункт <code>TradingDays</code> в меню <code>Actions</code>.</p> <p><strong>Важно:</strong> текущее время определяется временем на сервере, где находится робот. В данный момент для роботов, торгующих на криптовалютных биржах, это UTC, для всех остальных это UTC +3 (МСК). Текущее время на сервере отображается в виджете <code>Robots</code> в столбце <code>Robot time</code>, настоятельно рекомендуется ориентироваться именно на это время.</p> <h3 id="_5-2-27-to0" tabindex="-1"><a href="#_5-2-27-to0" class="header-anchor">#</a> 5.2.27. To0 <div class="anchor-container" data-v-72af3cd3><span id="p.to0" data-v-72af3cd3></span><span id="to0" data-v-72af3cd3></span></div></h3> <p>Использование данного параметра позволяет вести торговлю только в сторону закрытия позиции. Когда позиция портфеля достигнет нуля, торговля остановится.</p> <p><strong>Важно:</strong> если установлен флаг <a href="/bot-doc/docs/05-params-description.html#p.virtual_0_pos">Virt_0_pos</a>, то можно получить такое поведение робота, что позиция никогда не попадает ровно в 0, а все время переворачивается то в одну, то в другую сторону.</p> <h3 id="_5-2-28-opened" tabindex="-1"><a href="#_5-2-28-opened" class="header-anchor">#</a> 5.2.28. Opened <div class="anchor-container" data-v-72af3cd3><span id="p.opened" data-v-72af3cd3></span><span id="opened" data-v-72af3cd3></span></div></h3> <p>Параметр, используемый для подсчета финансового результата, вычисляется по формуле:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>d</mi><mo>=</mo><mo>−</mo><mrow><mo fence="true">(</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>b</mi><mi>o</mi><mi>u</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow></msub><mi>t</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><msub><mi>e</mi><mi>i</mi></msub><mo>×</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mi>A</mi><mi>m</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mi>i</mi></msub><mo>×</mo><mi>l</mi><mi>o</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>z</mi><msub><mi>e</mi><mi>i</mi></msub><mo>×</mo><mi>M</mi><mi>u</mi><mi>l</mi><msub><mi>t</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mo fence="true">(</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>s</mi><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mi>t</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><msub><mi>e</mi><mi>i</mi></msub><mo>×</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mi>A</mi><mi>m</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mi>i</mi></msub><mo>×</mo><mi>l</mi><mi>o</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>z</mi><msub><mi>e</mi><mi>i</mi></msub><mo>×</mo><mi>M</mi><mi>u</mi><mi>l</mi><msub><mi>t</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Opened = -\left(\sum_{i\in bought}tradePrice_i\times tradeAmount_i\times lotSize_i\times Mult_i\right)+
\left(\sum_{i\in sold}tradePrice_i\times tradeAmount_i\times lotSize_i\times Mult_i\right),</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:2.05002em;"></span><span class="strut bottom" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mrel">=</span><span class="mord">−</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">∈</span><span class="mord mathit">b</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">h</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit">A</span><span class="mord mathit">m</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mbin">+</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">∈</span><span class="mord mathit">s</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">d</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit">A</span><span class="mord mathit">m</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mpunct">,</span></span></span></span></span></p> <p>где tradePrice<sub>i</sub> - цена сделки;<br>
tradeAmount<sub>i</sub> - количество лотов в сделке;<br>
lotSize<sub>i</sub> - множитель для перевода целых объемов в дробные;<br>
bought - список сделок на покупку;<br>
sold - список сделок на продажу;<br>
Mult<sub>i</sub> - <a href="/bot-doc/docs/05-params-description.html#s.fin_res_mult">Fin res multiplier</a> инструмента портфеля.</p> <h3 id="_5-2-29-commision-sum" tabindex="-1"><a href="#_5-2-29-commision-sum" class="header-anchor">#</a> 5.2.29. Commision sum <div class="anchor-container" data-v-72af3cd3><span id="p.opened_comission" data-v-72af3cd3></span><span id="commision-sum" data-v-72af3cd3></span></div></h3> <p>Сумма комиссии по всем сделкам портфеля, используется для подсчёта финансового результата.</p> <h3 id="_5-2-30-decimals" tabindex="-1"><a href="#_5-2-30-decimals" class="header-anchor">#</a> 5.2.30. Decimals <div class="anchor-container" data-v-72af3cd3><span id="p.decimals" data-v-72af3cd3></span><span id="decimals" data-v-72af3cd3></span></div></h3> <p>Параметр, определяющий сколько знаков после десятичной точки отображается в параметрах, значение которых является дробным числом.
Стоит отметить, что робот использует настоящие цены, пришедшие с биржи, в то время как в интерфейсе, при использовании параметра <code>Decimals</code>, может отображаться округленное значение.</p> <h3 id="_5-2-31-custom-trade" tabindex="-1"><a href="#_5-2-31-custom-trade" class="header-anchor">#</a> 5.2.31. Custom trade <div class="anchor-container" data-v-72af3cd3><span id="p.custom_trade" data-v-72af3cd3></span><span id="custom-trade" data-v-72af3cd3></span></div></h3> <p>Позволяет использовать <code>Trade formula</code> для подсчета раздвижки в таблице с финансовыми результатами.</p> <h3 id="_5-2-32-trade-formula" tabindex="-1"><a href="#_5-2-32-trade-formula" class="header-anchor">#</a> 5.2.32. Trade formula <div class="anchor-container" data-v-72af3cd3><span id="p.trade_formula" data-v-72af3cd3></span><span id="trade-formula" data-v-72af3cd3></span></div></h3> <p>Формула на языке программирования <a href="/bot-doc/docs/08-c-api.html#_8-c">C++</a> для подсчета раздвижки в таблице с финансовыми результатами, вы пишете только тело функции и должны вернуть значение типа <code>double</code>. Функция вызывается в момент когда получены все необходимые сделки для подсчета раздвижки и добавления
ее в таблицу (при этом сделки могут быть НЕ по всем бумагам портфеля). На каждый финансовый инструмент портфеля будет доступно не больше одной сделки, если по какой-либо бумаге прошло несколько сделок, относящихся к данной раздвижке, то будет доступна только одна сделка, но с суммарным количеством
и со средней ценой.</p> <h3 id="_5-2-33-extra-formulas" tabindex="-1"><a href="#_5-2-33-extra-formulas" class="header-anchor">#</a> 5.2.33. Extra formulas <div class="anchor-container" data-v-72af3cd3><span id="p.ext_formulas" data-v-72af3cd3></span><span id="extra-formulas" data-v-72af3cd3></span></div></h3> <p>Флаг, включает расчёт <code>Extra field#1</code> и <code>Extra field#2</code>.</p> <h3 id="_5-2-34-extra-field-1-и-extra-field-2" tabindex="-1"><a href="#_5-2-34-extra-field-1-и-extra-field-2" class="header-anchor">#</a> 5.2.34. Extra field#1 и Extra field#2 <div class="anchor-container" data-v-72af3cd3><span id="p.ext_field1_" data-v-72af3cd3></span><span id="p.ext_field2_" data-v-72af3cd3></span><span id="extra-field#1-и-extra-field#2" data-v-72af3cd3></span></div></h3> <p>Поля для дополнительных формул на языке программирования <a href="/bot-doc/docs/08-c-api.html#c">C++</a>, вы пишете только тело функции и должны вернуть значение типа <code>double</code>.</p> <h3 id="_5-2-35-disable-portfolio" tabindex="-1"><a href="#_5-2-35-disable-portfolio" class="header-anchor">#</a> 5.2.35. Disable portfolio <div class="anchor-container" data-v-72af3cd3><span id="p.disabled" data-v-72af3cd3></span><span id="disable-portfolio" data-v-72af3cd3></span></div></h3> <p>Полностью выключить портфель из всех расчетов и торговли, не удаляя его.</p> <p><strong>Важно:</strong> при снятии этой галки и восстановлении работы портфеля возможно переоткрытие торговых стаканов и, как следствие, приостановка торговли во всех портфелях, использующих то же дата подключение, на время переоткрытия стаканов.</p> <h3 id="_5-2-36-sell-buy-clicker" tabindex="-1"><a href="#_5-2-36-sell-buy-clicker" class="header-anchor">#</a> 5.2.36. Sell/Buy clicker <div class="anchor-container" data-v-72af3cd3><span id="p.sell_portfolio" data-v-72af3cd3></span><span id="p.buy_portfolio" data-v-72af3cd3></span><span id="sell/buy-clicker" data-v-72af3cd3></span></div></h3> <p>&quot;Кликер&quot;, выставить заявку на продажу/покупку заданного количества портфелей. Заявки выставляются сразу по всем инструментам портфеля. Ручной способ совершения сделок всем портфелем сразу не дожидаясь срабатывания сигналов <code>Sell</code>&gt;=<code>Lim_sell</code> и <code>Buy</code>&lt;=<code>Lim_buy</code>.</p> <h3 id="_5-2-37-to-market" tabindex="-1"><a href="#_5-2-37-to-market" class="header-anchor">#</a> 5.2.37. To market <div class="anchor-container" data-v-72af3cd3><span id="p.to_market" data-v-72af3cd3></span><span id="to-market" data-v-72af3cd3></span></div></h3> <p>&quot;Кликер&quot; позволяет принудительно захеджировать позиции, не дожидаясь срабатывания автохеджа и др параметров. Происходит снятие всех заявок, кроме заявок первой ноги, выставленных по алгоритму и обратное выставление их по рыночным ценам (с учетом параметра <a href="/bot-doc/docs/05-params-description.html#s.k_sl">k_sl</a>) (по каждому инструменту второй ноги ставится не более одной выравнивающей заявки).</p> <h3 id="_5-2-38-place-order" tabindex="-1"><a href="#_5-2-38-place-order" class="header-anchor">#</a> 5.2.38. Place order <div class="anchor-container" data-v-72af3cd3><span id="p.order_security" data-v-72af3cd3></span><span id="place-order" data-v-72af3cd3></span></div></h3> <p>Позволяет выставить заявку по одному из инструментов портфеля, не дожидаясь срабатывания настроенных условий портфеля, в т.ч. при выключенной торговле портфеля. Для того, чтобы воспользоваться этой опцией необходимо сделать клик по голубой ячейке в столбце <code>Place order</code> в таблице <code>Portfolios table</code> и выбрать необходимые параметры заявки, далее нажать на кнопку <code>Place order</code>.<br>
При включенной торговле выставленная таким образом заявка может привести к срабатыванию параметров:<br> <code>Hedge (sec)</code>, <code>SLE</code>, <code>TE</code>.<br>
Для удаления выставленной таким способом заявки потребуется биржевой терминал, где вручную снимается заявка или это можно сделать в роботе с помощью кнопки <code>Hard stop</code> (описание в п.3.4. <a href="/bot-doc/docs/03-params-description.html#управление-портфелями">Управление_портфелями</a>)</p> <h3 id="_5-2-39-sell-buy" tabindex="-1"><a href="#_5-2-39-sell-buy" class="header-anchor">#</a> 5.2.39. Sell/Buy <div class="anchor-container" data-v-72af3cd3><span id="p.sell" data-v-72af3cd3></span><span id="p.buy" data-v-72af3cd3></span><span id="sell/buy" data-v-72af3cd3></span></div></h3> <p><code>Sell</code> – расчетная цена на продажу. Нередактируемый параметр.<br> <code>Buy</code> – расчетная цена на покупку. Нередактируемый параметр.<br>
Упрощенная формула для двух бумаг:</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>I</mi><mi>s</mi><mspace width="0.5em"></mspace><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo>:</mo><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><mi>y</mi><mo>=</mo><mi>B</mi><mi>u</mi><mi>y</mi><mo separator="true">,</mo><mi>S</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mspace width="0.5em"></mspace><mi>l</mi><mi>e</mi><mi>g</mi><mo>:</mo><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><mi>y</mi><mo>=</mo><mi>S</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></mrow><annotation encoding="application/x-tex">{Is\enspace first: On\enspace buy=Buy, Second\enspace leg: On\enspace buy=Sell}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit">s</span><span class="mord mspace enspace"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mrel">:</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit">d</span><span class="mord mspace enspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">:</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>B</mi><mi>u</mi><mi>y</mi><mo>=</mo><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mn>1</mn></msub><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>1</mn></msub><mo>−</mo><mi>b</mi><mi>i</mi><msub><mi>d</mi><mn>2</mn></msub><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">{Buy=offer_1Ratio\_sign_1ratio_1-bid_2Ratio\_sign_2ratio_2}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>S</mi><mi>e</mi><mi>l</mi><mi>l</mi><mo>=</mo><mi>b</mi><mi>i</mi><msub><mi>d</mi><mn>1</mn></msub><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>1</mn></msub><mo>−</mo><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mn>2</mn></msub><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">{Sell=bid_1Ratio\_sign_1ratio_1-offer_2Ratio\_sign_2ratio_2}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">=</span><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo>=</mo><mo>+</mo><mspace width="0.5em"></mspace><mi>o</mi><mi>r</mi><mspace width="0.5em"></mspace><mo>×</mo></mrow></mrow><annotation encoding="application/x-tex">{Ratio\_sign =+\enspace or\enspace \times}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.99333em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord">+</span><span class="mord mspace enspace"></span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mspace enspace"></span><span class="mbin">×</span></span></span></span></span></p> <p>Формулы расчета <code>Sell</code> и <code>Buy</code> для любого количества ног:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>u</mi><mi>y</mi><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi></mrow></msub><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mi>b</mi><mi>i</mi><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>S</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>B</mi><mi>u</mi><mi>y</mi></mrow></mtd></mtr></mtable></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Buy=\sum_{i} 
        \begin{cases}-bid_i,&amp; On\enspace buy_i=Sell\\
                     offer_i,&amp; On\enspace buy_i=Buy\end{cases} 
        \begin{cases}+,&amp; Ratio\_sign_i=+\\
                \times,&amp; Ratio\_sign_i=\times\end{cases} 
ratio_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.027669em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>e</mi><mi>l</mi><mi>l</mi><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi></mrow></msub><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>b</mi><mi>i</mi><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>B</mi><mi>u</mi><mi>y</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>S</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></mtd></mtr></mtable></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Sell=\sum_{i} 
        \begin{cases}bid_i,&amp; On\enspace buy_i=Buy\\
                  -offer_i,&amp; On\enspace buy_i=Sell\end{cases} 
        \begin{cases}+,&amp; Ratio\_sign_i=+\\
                \times,&amp; Ratio\_sign_i=\times\end{cases} 
ratio_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.027669em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p>Наглядно продемонстрирована работа данных параметров в этом видео:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/p69X-3l-VLc" title="Описание параметра Sell Buy" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h3 id="_5-2-40-price-s-price-b" tabindex="-1"><a href="#_5-2-40-price-s-price-b" class="header-anchor">#</a> 5.2.40. Price_s/Price_b <div class="anchor-container" data-v-72af3cd3><span id="p.price_s" data-v-72af3cd3></span><span id="p.price_b" data-v-72af3cd3></span><span id="price_s/price_b" data-v-72af3cd3></span></div></h3> <p><code>Price_s</code> – цена выставления заявки на продажу по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге, вычисляется как обратная функция для <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a>, где цена <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a> заменяется на <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_Sell</a>. Нередактируемый параметр.<br> <code>Price_b</code> – цена выставления заявки на покупку по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге, вычисляется как обратная функция для <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a>, где цена <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a> заменяется на <a href="/bot-doc/docs/05-params-description.html#p.lim_b">Lim_Buy</a>. В общем случае это та цена, по которой робот &quot;хочет&quot; купить и продать по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту.
Нередактируемый параметр.</p> <p>Формулы расчета <code>Price_s</code> и <code>Price_b</code> для двух бумаг:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mo>=</mo><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>l</mi><mo>−</mo><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mn>2</mn></msub><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">/</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>1</mn></msub><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Price\_s=\left(Lim\_sell-offer_2
\begin{cases}+,&amp; Ratio\_sign_2=+\\
        \times,&amp; Ratio\_sign_2=\times\end{cases}
ratio_2\right)
\begin{cases}-,&amp; Ratio\_sign_1=+\\
        /,&amp; Ratio\_sign_1=\times\end{cases}
ratio_1 - k_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mbin">−</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">/</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>b</mi><mo>=</mo><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>u</mi><mi>y</mi><mo>+</mo><mi>b</mi><mi>i</mi><msub><mi>d</mi><mn>2</mn></msub><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">/</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Price\_b=\left(Lim\_buy+bid_2
\begin{cases}+,&amp; Ratio\_sign_2=+\\
        \times,&amp; Ratio\_sign_2=\times\end{cases}
ratio_2\right)
\begin{cases}-,&amp; Ratio\_sign_1=+\\
        /,&amp; Ratio\_sign_1=\times\end{cases}
ratio_1 + k_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">b</span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">+</span><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">/</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p>Формулы расчета <code>Price_s</code> и <code>Price_b</code> для любого количества ног:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>s</mi><mo>=</mo><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mi>i</mi></msub><mo>−</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>≠</mo><mi>i</mi><mi>s</mi><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>b</mi><mi>i</mi><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>B</mi><mi>u</mi><mi>y</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>S</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></mtd></mtr></mtable></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">/</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><msub><mi>s</mi><mrow><mi>i</mi><mi>s</mi><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>k</mi><mrow><mi>i</mi><mi>s</mi><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Price\_s=\left(Lim\_sell_i-\sum_{i \neq isfirst}
\begin{cases}bid_i,&amp; On\enspace buy_i=Buy\\
                  -offer_i,&amp; On\enspace buy_i=Sell\end{cases} 
        \begin{cases}+,&amp; Ratio\_sign_i=+\\
                \times,&amp; Ratio\_sign_i=\times\end{cases} 
	ratio_i
\right) 
               \begin{cases}
	          -,&amp; Ratio\_sign=+\\
                  /,&amp; Ratio\_sign=\times 
	       \end{cases} 
ratio\_s_{isfirst} - k_{isfirst}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:2.05002em;"></span><span class="strut bottom" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.01968em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mop op-limits"><span class="vlist"><span style="top:1.2172049999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">≠</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">/</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>b</mi><mo>=</mo><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>≠</mo><mi>i</mi><mi>s</mi><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mi>b</mi><mi>i</mi><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>S</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>o</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>O</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>b</mi><mi>u</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>B</mi><mi>u</mi><mi>y</mi></mrow></mtd></mtr></mtable></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>+</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>×</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><msub><mi>n</mi><mi>i</mi></msub><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><msub><mi>o</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>−</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo>=</mo><mo>+</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">/</mi><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo>=</mo><mo>×</mo></mrow></mtd></mtr></mtable></mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi mathvariant="normal">_</mi><msub><mi>b</mi><mrow><mi>i</mi><mi>s</mi><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>k</mi><mrow><mi>i</mi><mi>s</mi><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Price\_b=\left(Lim\_buy_i-\sum_{i \neq isfirst}
\begin{cases}-bid_i,&amp; On\enspace buy_i=Sell\\
                     offer_i,&amp; On\enspace buy_i=Buy\end{cases} 
        \begin{cases}+,&amp; Ratio\_sign_i=+\\
                \times,&amp; Ratio\_sign_i=\times\end{cases} 
        ratio_i
\right) 
             \begin{cases}
	       -,&amp; Ratio\_sign=+\\
               /,&amp; Ratio\_sign=\times 
	     \end{cases} 
ratio\_b_{isfirst} + k_{isfirst}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:2.05002em;"></span><span class="strut bottom" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">i</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">b</span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-0.89502em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mop op-limits"><span class="vlist"><span style="top:1.2172049999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">≠</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">b</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">+</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">×</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">o</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9049999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-0.89502em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">−</span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">/</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord">+</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord">×</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p>Видео, наглядно объясняющее работу параметров <code>Price_s/Price_b</code>:</p> <iframe width="735" height="415" src="https://www.youtube.com/embed/PKGbweKJbNE" title="Описание параметра Prices" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe> <h3 id="_5-2-41-sell-buy-status" tabindex="-1"><a href="#_5-2-41-sell-buy-status" class="header-anchor">#</a> 5.2.41. Sell/Buy status <div class="anchor-container" data-v-72af3cd3><span id="p.sell_status" data-v-72af3cd3></span><span id="p.buy_status" data-v-72af3cd3></span><span id="sell/buy-status" data-v-72af3cd3></span></div></h3> <p>Статус заявки на продажу/покупку по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту. Существуют следующие статусы:</p> <p>running - (тут должно быть краткое описание)</p> <p>free - (описание)</p> <p>Для того чтобы освободить &quot;зависшую&quot; заявку, необходимо сделать двойной клик на ячейке таблицы. Ручная смена статуса может привести к потере заявки роботом, данную операцию рекомендуется делать только в крайних случаях.</p> <h3 id="_5-2-42-return-first" tabindex="-1"><a href="#_5-2-42-return-first" class="header-anchor">#</a> 5.2.42. Return first <div class="anchor-container" data-v-72af3cd3><span id="p.return_first" data-v-72af3cd3></span><span id="return-first" data-v-72af3cd3></span></div></h3> <p>Оборот по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаге, вычисляется с момента старта серверной части робота как сумма модулей количества лотов в сделках по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту. Можно установить ноль двойным кликом.</p> <p><strong>Важно:</strong> для отображения на сайте используется <code>lot_size</code>.</p> <h3 id="_5-2-43-fin-res" tabindex="-1"><a href="#_5-2-43-fin-res" class="header-anchor">#</a> 5.2.43. Fin res <div class="anchor-container" data-v-72af3cd3><span id="p.fin_res" data-v-72af3cd3></span><span id="fin-res" data-v-72af3cd3></span></div></h3> <p>Предполагаемый финансовый результат портфеля, вычисляется по формуле:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>r</mi><mi>e</mi><mi>s</mi><mo>=</mo><mi>O</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>d</mi><mo>+</mo><mi>C</mi><mi>o</mi><mi>m</mi><mi>m</mi><mi>i</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>s</mi><mi>u</mi><mi>m</mi><mo>+</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>s</mi><mi>e</mi><mi>c</mi><mi>s</mi></mrow></msub><mi>C</mi><mi>u</mi><mi>r</mi><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub><mo>×</mo><mi>l</mi><mi>o</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>z</mi><msub><mi>e</mi><mi>i</mi></msub><mo>×</mo><mi>M</mi><mi>u</mi><mi>l</mi><msub><mi>t</mi><mi>i</mi></msub><mo>×</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>B</mi><mi>i</mi><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext></mtext></mtext><mi>C</mi><mi>u</mi><mi>r</mi><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>O</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext></mtext></mtext><mi>C</mi><mi>u</mi><mi>r</mi><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub><mo>&lt;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Fin\enspace res=Opened+Commission\enspace sum+\sum_{i\in secs}Curpos_i \times lotSize_i \times Mult_i \times
   \begin{cases} 
     secBid_i, &amp;\text{if } Curpos_i&gt;0\\ 
   secOffer_i, &amp;\text{if } Curpos_i&lt;0 
\end{cases},</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.055039em;vertical-align:-1.305039em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">m</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit">s</span><span class="mord mathit">u</span><span class="mord mathit">m</span><span class="mbin">+</span><span class="mop op-limits"><span class="vlist"><span style="top:1.177669em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">∈</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit">s</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace"></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace"></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&lt;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span></p> <p>где secBid<sub>i</sub> - лучшая цена на покупку инструмента портфеля;<br>
secOffer<sub>i</sub> - лучшая цена на продажу инструмента портфеля;<br>
lotSize<sub>i</sub> - множитель для перевода целых объемов в дробные;<br>
Curpos<sub>i</sub> - текущая позиция инструмента портфеля;<br>
Mult - <a href="/bot-doc/docs/05-params-description.html#s.fin_res_mult">Fin res multiplier</a> инструмента портфеля;<br>
secs - список инструментов портфеля.</p> <p>Инструкцию по расчету и настройке вывода финансового результата можно посмотреть здесь <a href="https://instructions.fkviking.com/fin_result_guide.pdf" target="_blank" rel="noopener noreferrer">Fin res manual<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <h3 id="_5-2-44-fin-res-wo-c" tabindex="-1"><a href="#_5-2-44-fin-res-wo-c" class="header-anchor">#</a> 5.2.44. Fin res wo C <div class="anchor-container" data-v-72af3cd3><span id="p.fin_res_wo_c" data-v-72af3cd3></span><span id="fin-res-wo-c" data-v-72af3cd3></span></div></h3> <p><code>Fin res</code> без учета комиссии. Вычисляется по формуле:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mspace width="0.5em"></mspace><mi>r</mi><mi>e</mi><mi>s</mi><mo>=</mo><mi>O</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>d</mi><mo>+</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>s</mi><mi>e</mi><mi>c</mi><mi>s</mi></mrow></msub><mi>C</mi><mi>u</mi><mi>r</mi><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub><mo>×</mo><mi>l</mi><mi>o</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>z</mi><msub><mi>e</mi><mi>i</mi></msub><mo>×</mo><mi>M</mi><mi>u</mi><mi>l</mi><msub><mi>t</mi><mi>i</mi></msub><mo>×</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>B</mi><mi>i</mi><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext></mtext></mtext><mi>C</mi><mi>u</mi><mi>r</mi><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>O</mi><mi>f</mi><mi>f</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext></mtext></mtext><mi>C</mi><mi>u</mi><mi>r</mi><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>i</mi></msub><mo>&lt;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Fin\enspace res=Opened+\sum_{i\in secs}Curpos_i \times lotSize_i \times Mult_i \times 
   \begin{cases} 
     secBid_i, &amp;\text{if } Curpos_i&gt; 0\\ 
   secOffer_i, &amp;\text{if } Curpos_i&lt; 0 
\end{cases},</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.055039em;vertical-align:-1.305039em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mspace enspace"></span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mbin">+</span><span class="mop op-limits"><span class="vlist"><span style="top:1.177669em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">∈</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit">s</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">×</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace"></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mspace"></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit">s</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&lt;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span></p> <p>где secBid<sub>i</sub> - лучшая цена на покупку инструмента портфеля;<br>
secOffer<sub>i</sub> - лучшая цена на продажу инструмента портфеля;<br>
lotSize<sub>i</sub> - множитель для перевода целых объемов в дробные;<br>
Curpos<sub>i</sub> - текущая позиция инструмента портфеля;<br>
Mult<sub>i</sub> - <a href="/bot-doc/docs/05-params-description.html#s.fin_res_mult">Fin res multiplier</a> инструмента портфеля;<br>
secs - список инструментов портфеля.</p> <h3 id="_5-2-45-comment" tabindex="-1"><a href="#_5-2-45-comment" class="header-anchor">#</a> 5.2.45. Comment <div class="anchor-container" data-v-72af3cd3><span id="p.comment" data-v-72af3cd3></span><span id="comment" data-v-72af3cd3></span></div></h3> <p>При необходимости к каждому порфтелю можно добавить свой комментарий. Максимально допустимое число символов для комментария 100.</p> <h3 id="_5-2-46-color" tabindex="-1"><a href="#_5-2-46-color" class="header-anchor">#</a> 5.2.46. Color <div class="anchor-container" data-v-72af3cd3><span id="p.color" data-v-72af3cd3></span><span id="color" data-v-72af3cd3></span></div></h3> <p>При небходимости можно выделить портфель цветом в поле <code>color</code>.</p> <h2 id="_5-3-параметры-инструментов-портфеля" tabindex="-1"><a href="#_5-3-параметры-инструментов-портфеля" class="header-anchor">#</a> 5.3. Параметры инструментов портфеля  <div class="anchor-container" data-v-72af3cd3><span id="параметры-инструментов-портфеля" data-v-72af3cd3></span></div></h2> <p>Далее дано описание параметров инструментов портфеля. Все параметры являются редактируемыми, если прямо не указано иное.</p> <h3 id="_5-3-1-seckey" tabindex="-1"><a href="#_5-3-1-seckey" class="header-anchor">#</a> 5.3.1. SecKey <div class="anchor-container" data-v-72af3cd3><span id="s.sec_key" data-v-72af3cd3></span><span id="seckey" data-v-72af3cd3></span></div></h3> <p>Уникальный идентификатор инструмента портфеля. Нередактируемый параметр.</p> <h3 id="_5-3-2-secboard" tabindex="-1"><a href="#_5-3-2-secboard" class="header-anchor">#</a> 5.3.2. SecBoard <div class="anchor-container" data-v-72af3cd3><span id="s.sec_board" data-v-72af3cd3></span><span id="secboard" data-v-72af3cd3></span></div></h3> <p>Режим инструмента портфеля. Нередактируемый параметр.</p> <h3 id="_5-3-3-seccode" tabindex="-1"><a href="#_5-3-3-seccode" class="header-anchor">#</a> 5.3.3. SecCode <div class="anchor-container" data-v-72af3cd3><span id="s.sec_code" data-v-72af3cd3></span><span id="seccode" data-v-72af3cd3></span></div></h3> <p>Код инструмента портфеля. Нередактируемый параметр.</p> <h3 id="_5-3-4-exchange" tabindex="-1"><a href="#_5-3-4-exchange" class="header-anchor">#</a> 5.3.4. Exchange <div class="anchor-container" data-v-72af3cd3><span id="s.sec_type" data-v-72af3cd3></span><span id="exchange" data-v-72af3cd3></span></div></h3> <p>Название биржи, на которой торгуется данная бумага. Нередактируемый параметр.</p> <h3 id="_5-3-5-curpos" tabindex="-1"><a href="#_5-3-5-curpos" class="header-anchor">#</a> 5.3.5. Curpos <div class="anchor-container" data-v-72af3cd3><span id="s.pos" data-v-72af3cd3></span><span id="curpos" data-v-72af3cd3></span></div></h3> <p>Текущая позиция робота по данному инструменту в лотах.</p> <p><strong>Важно:</strong> для отображения на сайте используется <code>lot_size</code>.</p> <h3 id="_5-3-6-count-type" tabindex="-1"><a href="#_5-3-6-count-type" class="header-anchor">#</a> 5.3.6. Count type <div class="anchor-container" data-v-72af3cd3><span id="s.count_type" data-v-72af3cd3></span><span id="count-type" data-v-72af3cd3></span></div></h3> <p>Параметр позволяет выбрать константное значение <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> или использовать <a href="/bot-doc/docs/05-params-description.html#s.count_formula">Count formula</a></p> <h3 id="_5-3-7-count" tabindex="-1"><a href="#_5-3-7-count" class="header-anchor">#</a> 5.3.7. Count <div class="anchor-container" data-v-72af3cd3><span id="s.count" data-v-72af3cd3></span><span id="count" data-v-72af3cd3></span></div></h3> <p>Количество лотов инструмента в одном портфеле.</p> <p><strong>Важно:</strong> для отображения на сайте используется <code>lot_size</code>.</p> <p><strong>Важно:</strong> для многих криптовалютных бирж данный параметр указывается &quot;как бы в сатошах&quot;, т.е. чтобы купить/продать 1 лот на бирже необходимо указать количество 100 000 000 (соответственно, 0.1 лота сооветствует значение 10 000 000 и т.д.). При добавлении бумаги в портфель обращайте внимание на столбец <code>Price to lot mult</code>.</p> <p><strong>Важно:</strong> при включенном <a href="/bot-doc/docs/05-params-description.html#p.virtual_0_pos">Virt 0 pos</a> <code>Count</code> – это минимальное количество, которым торгует робот по соответствующему инструменту, в противном случае может быть выставлена заявка в количестве меньшем чем <code>Count</code> (в случае закрытия позиции и чтобы &quot;попасть&quot; в <a href="/bot-doc/docs/05-params-description.html#p.v_min">v_min/v_max</a>).</p> <h3 id="_5-3-8-count-formula" tabindex="-1"><a href="#_5-3-8-count-formula" class="header-anchor">#</a> 5.3.8. Count formula <div class="anchor-container" data-v-72af3cd3><span id="s.count_formula" data-v-72af3cd3></span><span id="count-formula" data-v-72af3cd3></span></div></h3> <p>Количество лотов инструмента в одном портфеле, задаётся как код на языке программирования <a href="/bot-doc/docs/08-c-api.html#_8-c">C++</a>. Вы пишете только тело функции, и должны вернуть значение типа <code>double</code>.</p> <p><strong>Важно:</strong> значения <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a>
или <a href="/bot-doc/docs/05-params-description.html#s.count_formula">Count formula</a> определяют соотношение именно между позициями инструментов портфеля (соотношение в конкретной сделке может отличаться). По этой же причине значение <a href="/bot-doc/docs/05-params-description.html#s.count_formula">Count formula</a> не зависит от направления выставляемой заявки.</p> <p><strong>Важно:</strong> настоятельно рекомендуется для <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаги никогда не возвращать значение 0, если вы хотите не торговать, используйте <code>Ratio formula</code> и задавайте необходимые значения для раздвижки. Если вы все-таки получили <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a>
равный 0 для <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаги, то портфель не будет торговать ни одной бумагой и для подсчета позиции портфеля в том месте, где необходимо поделить на <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаги (который в вашем случае равен 0) будет делиться на 1.</p> <h3 id="_5-3-9-on-buy" tabindex="-1"><a href="#_5-3-9-on-buy" class="header-anchor">#</a> 5.3.9. On buy <div class="anchor-container" data-v-72af3cd3><span id="s.on_buy" data-v-72af3cd3></span><span id="on-buy" data-v-72af3cd3></span></div></h3> <p>Определяет будем ли мы покупать или продавать инструмент при срабатывании сигнала на покупку по главному инструменту. Данный параметр настраивается только для второй ноги. Для первой ноги по умолчанию всегда <code>On Buy</code> = <code>Buy</code>. При срабатывании сигнала на продажу робот возьмет противоположное значение.</p> <p><strong>Пример:</strong>
Для <code>is_first</code> инструмента <code>On Buy</code> = <code>Buy</code>
Для второй ноги <code>On Buy</code> = <code>Sell</code>
При таких настройках при срабатывании сигнала на покупку робот будет стремиться купить первую ногу и затем продать вторую.
При таких настройках при срабатывании сигнала на продажу робот будет стремиться продать первую ногу и затем купить вторую.</p> <p>Для  <code>is_first</code> инструмента <code>On Buy</code> = <code>Buy</code>
Для второй ноги <code>On Buy</code> = <code>Buy</code>
При таких настройках при срабатывании сигнала на покупку робот будет стремиться купить первую ногу и затем тоже купить вторую.
При таких настройках при срабатывании сигнала на продажу робот будет стремиться продать первую ногу и затем тоже продать вторую.</p> <h3 id="_5-3-10-is-first" tabindex="-1"><a href="#_5-3-10-is-first" class="header-anchor">#</a> 5.3.10. Is first <div class="anchor-container" data-v-72af3cd3><span id="s.is_first" data-v-72af3cd3></span><span id="is-first" data-v-72af3cd3></span></div></h3> <p>Определяет, является ли бумага главным инструментом портфеля. Позиция портфеля считается по главному инструменту. <a href="/bot-doc/docs/05-params-description.html#s.on_buy">On buy</a> такого инструмента всегда указывается как <a href="/bot-doc/docs/05-params-description.html#p.sell">Buy</a>.</p> <h3 id="_5-3-11-k" tabindex="-1"><a href="#_5-3-11-k" class="header-anchor">#</a> 5.3.11. k <div class="anchor-container" data-v-72af3cd3><span id="s.k" data-v-72af3cd3></span><span id="k" data-v-72af3cd3></span></div></h3> <p>Задает размер искусственного проскальзывания (отступ от рыночной цены, т.е. при покупке цена выставления <code>offer</code> + <code>k</code>, при продаже цена выставления <code>bid</code>−<code>k</code>, где <code>bid</code> и <code>offer</code> – лучшие цены на продажу и покупку, соответственно).</p> <h3 id="_5-3-12-k-sl" tabindex="-1"><a href="#_5-3-12-k-sl" class="header-anchor">#</a> 5.3.12. k_sl <div class="anchor-container" data-v-72af3cd3><span id="s.k_sl" data-v-72af3cd3></span><span id="k_sl" data-v-72af3cd3></span></div></h3> <p>Аналог параметра <code>k</code>, но используется только во время перестановок заявок по <a href="/bot-doc/docs/05-params-description.html#s.sle">SLE</a> и <a href="/bot-doc/docs/05-params-description.html#s.te">TE</a>. Задает размер искусственного проскальзывания (отступ от рыночной цены, т.е. для заявки на покупку цена выставления <code>offer</code> + <code>k_sl</code>, для заявки на продажу цена выставления <code>bid</code>−<code>k_sl</code>, где <code>bid</code> и <code>offer</code> – лучшие цены на продажу и покупку, соответственно).</p> <h3 id="_5-3-13-sle" tabindex="-1"><a href="#_5-3-13-sle" class="header-anchor">#</a> 5.3.13. SLE <div class="anchor-container" data-v-72af3cd3><span id="s.sle" data-v-72af3cd3></span><span id="sle" data-v-72af3cd3></span></div></h3> <p>Включить/выключить функцию переставления по стоп-лоссу.</p> <h3 id="_5-3-14-sl" tabindex="-1"><a href="#_5-3-14-sl" class="header-anchor">#</a> 5.3.14. SL <div class="anchor-container" data-v-72af3cd3><span id="s.sl" data-v-72af3cd3></span><span id="sl" data-v-72af3cd3></span></div></h3> <p>Значение стоп-лосса, при достижении которого необходимо снимать заявку, если она не прошла до этого момента и бросать снова по новой рыночной цене (стоп-лосс откладывается от первоначальной цены выставления заявки).</p> <h3 id="_5-3-15-te" tabindex="-1"><a href="#_5-3-15-te" class="header-anchor">#</a> 5.3.15. TE <div class="anchor-container" data-v-72af3cd3><span id="s.te" data-v-72af3cd3></span><span id="te" data-v-72af3cd3></span></div></h3> <p>Параметр отвечает за включение/выключение функции переставления по таймеру.</p> <h3 id="_5-3-16-timer" tabindex="-1"><a href="#_5-3-16-timer" class="header-anchor">#</a> 5.3.16. Timer <div class="anchor-container" data-v-72af3cd3><span id="s.timer" data-v-72af3cd3></span><span id="timer" data-v-72af3cd3></span></div></h3> <p>Параметр, определяющий через сколько времени снимать заявку, если она не прошла до этого момента и бросать снова по новой рыночной цене.</p> <h3 id="_5-3-17-percent-of-quantity" tabindex="-1"><a href="#_5-3-17-percent-of-quantity" class="header-anchor">#</a> 5.3.17. Percent of quantity <div class="anchor-container" data-v-72af3cd3><span id="s.percent_of_quantity" data-v-72af3cd3></span><span id="percent-of-quantity" data-v-72af3cd3></span></div></h3> <p>Если на бирже в объеме лучшей цены на продажу или покупку (или в найденном объеме в стакане если <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook</code> или <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook + filter</code>), соответственно, есть нужное количество процентов (%) от объема заявки инструмента, не являющегося <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a>, и это условие выполняется для всех не <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструментов, то можно выставляться по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту. Таким образом если во второй ноге не достаточно объема для хеджирования, то заявка по первой ноге не выставляется даже если есть сигнал на покупку или на продажу.</p> <h3 id="_5-3-18-ratio-sign" tabindex="-1"><a href="#_5-3-18-ratio-sign" class="header-anchor">#</a> 5.3.18. Ratio sign <div class="anchor-container" data-v-72af3cd3><span id="s.ratio_sign" data-v-72af3cd3></span><span id="ratio-sign" data-v-72af3cd3></span></div></h3> <p>Знак используемый перед коэффициентом <a href="/bot-doc/docs/05-params-description.html#s.ratio">Ratio</a> при расчете цен <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a> и <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a>, ”+” или ”×”.</p> <h3 id="_5-3-19-ratio" tabindex="-1"><a href="#_5-3-19-ratio" class="header-anchor">#</a> 5.3.19. Ratio <div class="anchor-container" data-v-72af3cd3><span id="s.ratio" data-v-72af3cd3></span><span id="ratio" data-v-72af3cd3></span></div></h3> <p>Коэффициент, используемый при расчете цен <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a> и <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a>.</p> <h3 id="_5-3-20-fin-res-multiplier" tabindex="-1"><a href="#_5-3-20-fin-res-multiplier" class="header-anchor">#</a> 5.3.20. Fin res multiplier <div class="anchor-container" data-v-72af3cd3><span id="s.fin_res_mult" data-v-72af3cd3></span><span id="fin-res-multiplier" data-v-72af3cd3></span></div></h3> <p><code>Fin res multiplier</code> - множитель, используется для подсчета финансового результата, чтобы привести все цены к одной размерности.</p> <h3 id="_5-3-21-commission-type-и-commission" tabindex="-1"><a href="#_5-3-21-commission-type-и-commission" class="header-anchor">#</a> 5.3.21. Commission type и Commission <div class="anchor-container" data-v-72af3cd3><span id="s.comission_sign" data-v-72af3cd3></span><span id="s.comission" data-v-72af3cd3></span><span id="commission-type-и-commission" data-v-72af3cd3></span></div></h3> <p><code>Comission type</code> - gараметр, определяющий тип расчёта комиссии. Позволяет задать фиксированную сумму списания или процент об объема сделки.</p> <p><code>Commission</code> - комиссия по инструменту. Если <code>Commission type</code> указан как <code>%</code>, то комиссия указывается в процентах от цены сделки, а если как <code>pt</code>, то комиссия указывается в той же размерности, в которой считается финансовый результат по портфелю (например, для акции Сбербанка комиссия указывается в процентах и для большинства брокеров она равна 0.01 %, а для фьючерса на акцию Сбербанка комиссия указывается в пунктах и равна 0.25 пункта для скальперских сделок).</p> <h3 id="_5-3-22-client-code" tabindex="-1"><a href="#_5-3-22-client-code" class="header-anchor">#</a> 5.3.22. Client code <div class="anchor-container" data-v-72af3cd3><span id="s.client_code" data-v-72af3cd3></span><span id="client-code" data-v-72af3cd3></span></div></h3> <p>Код клиента с которого надо выставлять заявку по данной бумаге или пустая строка если необходимо выставлять с &quot;кода по умолчанию&quot;, отображает все коды, которые доступные для торговли соответствующим инструментом, код virtual означает торговлю &quot;в файл&quot; и может быть использован для тестирования стратегий; код, начинающийся с <a href="/bot-doc/docs/05-params-description.html#s.client_code">Round robin</a>, означает использование режима выставления заявок <a href="/bot-doc/docs/05-params-description.html#s.client_code">Round robin</a>.</p> <p><strong>Важно:</strong> Режим <a href="/bot-doc/docs/05-params-description.html#s.client_code">Round robin</a> означает выставление и снятие заявок через все подключения к бирже с заданным клиентским кодом по некоторому алгоритму, при этом поведение этого алгоритма для Московской биржи и для криптобирж различается. Это связано с особенностями торгов и типом подключений на биржах. На криптобиржах при использовании режима <a href="/bot-doc/docs/05-params-description.html#s.client_code">Round robin</a> происходит поочередное выставление и снятие заявок через подключения с одинаковым клиентским кодом. Все подключения из списка используются равномерно. Для криптобирж (не всех) это позволяет поднять общую пропускную способность клиентского счёта с помощью использования нескольких подключений с разными парами ключей. На рынках Московской биржи все подключения с одним кодом клиента держатся в очереди, порядок подключений в очереди зависит от скорости выставления заявок через эти подключения (кто в данный момент быстрее, тот первый в очереди, порядок подключений в очереди меняется не чаще раза в секунду, кроме того каждую секунду движение по очереди начинается заново, т.о. загрузка подключений НЕ равномерная). При измерении скорости (Round trip-а) выставления заявок учитывается только скорость некоторых заявок, назовём их важными. Важными заявками считаются заявки, выставленные по первой ноге по алгоритму (т.е не кликером, не стопом и прочими способами), причём только в случае если котирование отключено. Так же важными заявками являются заявки по второй ноге, выставленные по основному алгоритму, т.е. после сделки по первой ноге. Значения Round trip'a обнуляются раз в час, чтобы снова была возможность оценить скорость каждого из подключений и выбрать быстрейшее. Таким образом, для Московской биржи выбирается быстрейшее подключение и по возможности заявки выставляются с него.</p> <p><strong>Важно:</strong> код клиента не может быть пустым для бумаг с <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> отличным от нуля.</p> <h3 id="_5-3-23-mm" tabindex="-1"><a href="#_5-3-23-mm" class="header-anchor">#</a> 5.3.23. MM <div class="anchor-container" data-v-72af3cd3><span id="s.mm" data-v-72af3cd3></span><span id="mm" data-v-72af3cd3></span></div></h3> <p>Флаг, если взведен, то все заявки по инструменту выставляются с признаком &quot;заявка маркет-мейкера&quot; (работает не для всех подключений). Требуется обязательное согласование использование этого признака с самой биржей.</p> <h3 id="_5-3-24-tp" tabindex="-1"><a href="#_5-3-24-tp" class="header-anchor">#</a> 5.3.24. TP <div class="anchor-container" data-v-72af3cd3><span id="s.tp" data-v-72af3cd3></span><span id="tp" data-v-72af3cd3></span></div></h3> <p>Величина тейк-профит, используется при <a href="/bot-doc/docs/05-params-description.html#p.portfolio_type">Type</a> равном <code>TP algo</code> или <code>TP algo 2</code>, откладывается от цены сделки по заявке <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструмента.</p> <h3 id="_5-3-25-ratio-type" tabindex="-1"><a href="#_5-3-25-ratio-type" class="header-anchor">#</a> 5.3.25. Ratio type <div class="anchor-container" data-v-72af3cd3><span id="s.ratio_type" data-v-72af3cd3></span><span id="ratio-type" data-v-72af3cd3></span></div></h3> <p>Позволяет настроить использование константного значения <code>Ratio</code> или результат вычисления <code>Ratio formula</code> при расчёте значений <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a> и <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a>.</p> <h3 id="_5-3-26-ratio-buy-formula" tabindex="-1"><a href="#_5-3-26-ratio-buy-formula" class="header-anchor">#</a> 5.3.26. Ratio buy formula <div class="anchor-container" data-v-72af3cd3><span id="s.ratio_b_formula" data-v-72af3cd3></span><span id="ratio-buy-formula" data-v-72af3cd3></span></div></h3> <p>Параметр, используемый при расчете цены <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a>, задается как код на языке программирования <a href="/bot-doc/docs/08-c-api.html#_8-c">C++</a>. Вы пишете только тело функции и должны вернуть значение типа <code>double</code>.</p> <h3 id="_5-3-27-ratio-sell-formula" tabindex="-1"><a href="#_5-3-27-ratio-sell-formula" class="header-anchor">#</a> 5.3.27. Ratio sell formula <div class="anchor-container" data-v-72af3cd3><span id="s.ratio_s_formula" data-v-72af3cd3></span><span id="ratio-sell-formula" data-v-72af3cd3></span></div></h3> <p>Параметр, используемый при расчете цены <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a>, задается как код на языке программирования <a href="/bot-doc/docs/08-c-api.html#_8-c">C++</a>. Вы пишете только тело функции и должны вернуть значение типа <code>double</code>.</p> <h3 id="_5-3-28-fut-move-limits" tabindex="-1"><a href="#_5-3-28-fut-move-limits" class="header-anchor">#</a> 5.3.28. FUT move limits <div class="anchor-container" data-v-72af3cd3><span id="s.move_limits" data-v-72af3cd3></span><span id="fut-move-limits" data-v-72af3cd3></span></div></h3> <p>Флаг, если взведен, то при каждой смене дня, а именно в 00:00 МСК, будет осуществляться автоматическая подвижка лимитов по формулам:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>S</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>S</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mn>0</mn></msub><mo>−</mo><mfrac><mrow><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>S</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mn>0</mn></msub><mo>+</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>B</mi><mi>u</mi><msub><mi>y</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo>×</mo><mi>d</mi><mi>a</mi><mi>y</mi><mi>s</mi><mi mathvariant="normal">_</mi><mi>t</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>r</mi><mi>y</mi><mi mathvariant="normal">_</mi><mrow><mi>S</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow></mrow><mrow><mn>2</mn><mo>×</mo><mi>d</mi><mi>a</mi><mi>y</mi><mi>s</mi><mi mathvariant="normal">_</mi><mi>t</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>r</mi><mi>y</mi></mrow></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Lim\_Sell_1=Lim\_Sell_0- \frac{\left(Lim\_Sell_0+Lim\_Buy_0 \right) \times days\_to\_expiry\_{SPOT}}
{2\times days\_to\_expiry},</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.59001em;"></span><span class="strut bottom" style="height:2.58601em;vertical-align:-0.996em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.01968em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.01968em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathit">s</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.01968em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mbin">×</span><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathit">s</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>B</mi><mi>u</mi><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>B</mi><mi>u</mi><msub><mi>y</mi><mn>0</mn></msub><mo>−</mo><mfrac><mrow><mrow><mo fence="true">(</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>S</mi><mi>e</mi><mi>l</mi><msub><mi>l</mi><mn>0</mn></msub><mo>+</mo><mi>L</mi><mi>i</mi><mi>m</mi><mi mathvariant="normal">_</mi><mi>B</mi><mi>u</mi><msub><mi>y</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo>×</mo><mi>d</mi><mi>a</mi><mi>y</mi><mi>s</mi><mi mathvariant="normal">_</mi><mi>t</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>r</mi><mi>y</mi><mi mathvariant="normal">_</mi><mrow><mi>S</mi><mi>P</mi><mi>O</mi><mi>T</mi></mrow></mrow><mrow><mn>2</mn><mo>×</mo><mi>d</mi><mi>a</mi><mi>y</mi><mi>s</mi><mi mathvariant="normal">_</mi><mi>t</mi><mi>o</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>x</mi><mi>p</mi><mi>i</mi><mi>r</mi><mi>y</mi></mrow></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Lim\_Buy_1=Lim\_Buy_0- \frac{\left(Lim\_Sell_0+Lim\_Buy_0 \right)\times days\_to\_expiry\_{SPOT}}
{2\times days\_to\_expiry},</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.59001em;"></span><span class="strut bottom" style="height:2.58601em;vertical-align:-0.996em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mbin">×</span><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathit">s</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.01968em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathit">L</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">u</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mbin">×</span><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathit">s</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span></p> <p>где days_to_expiry - целое количество дней до экспирации данной бумаги;<br>
days_to_expirySPOT - целое количество дней до экспирации бумаги, отмеченной флагом <code>SPOT move limits</code> или 1, если такая бумага не указана;<br>
нижний индекс 0 означает текущее значение параметра;<br>
нижний индекс 1 означает новое значение параметра.</p> <p>Отметим, что при взведенном флаге <code>FUT move limits</code>, автосдвиг при каждой смене дня сработает в том числе при выключенных <a href="/bot-doc/docs/05-params-description.html#p.re_sell">re_sell</a>, <a href="/bot-doc/docs/05-params-description.html#p.re_buy">re_buy</a>.</p> <h3 id="_5-3-29-spot-move-limits" tabindex="-1"><a href="#_5-3-29-spot-move-limits" class="header-anchor">#</a> 5.3.29. SPOT move limits <div class="anchor-container" data-v-72af3cd3><span id="s.move_limits1" data-v-72af3cd3></span><span id="spot-move-limits" data-v-72af3cd3></span></div></h3> <p>Флаг, если взведен, то данная бумага используется в формулах для <code>FUT move limits</code>.</p> <h3 id="_5-3-30-depth-ob" tabindex="-1"><a href="#_5-3-30-depth-ob" class="header-anchor">#</a> 5.3.30. Depth OB <div class="anchor-container" data-v-72af3cd3><span id="s.depth_ob" data-v-72af3cd3></span><span id="depth-ob" data-v-72af3cd3></span></div></h3> <p>Максимальный уровень глубины стакана до которого включительно вычислять цены и объемы (в штуках шагов цены, считая от бида/оффера), доступен только для не <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a>, используется только в режимах <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook</code> и <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook + filter</code>.<br>
Если у Вас выбран режим <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook</code> и <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook + filter</code>, то необходимо следить за значением <code>Depth OB</code>, при слишком низких значениях параметра робот не сможет высчитывать цены и объемы, у вас будут нули в параметрах <code>Sell</code> и <code>Buy</code>.</p> <h3 id="_5-3-31-calc-price-ob" tabindex="-1"><a href="#_5-3-31-calc-price-ob" class="header-anchor">#</a> 5.3.31. Calc price OB <div class="anchor-container" data-v-72af3cd3><span id="s.ob_c_p_t" data-v-72af3cd3></span><span id="calc-price-ob" data-v-72af3cd3></span></div></h3> <p>Тип цены, используемой для расчета <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell</a>, <a href="/bot-doc/docs/05-params-description.html#p.buy">Buy</a>, <a href="/bot-doc/docs/05-params-description.html#p.price_s">Price_s</a>, <a href="/bot-doc/docs/05-params-description.html#p.price_b">Price_b</a>. Доступен только для не <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаг, используется только в режимах <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook</code> и <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook + filter</code>:</p> <ul><li><strong>Deepest</strong> – цена того уровня в стакане, на котором набрали искомый объем;</li> <li><strong>Weighted avg.</strong> – средневзвешенная цена до того уровня в стакане включительно, на котором набрали искомый объем.</li></ul> <h3 id="_5-3-32-trading-price-ob" tabindex="-1"><a href="#_5-3-32-trading-price-ob" class="header-anchor">#</a> 5.3.32. Trading price OB <div class="anchor-container" data-v-72af3cd3><span id="s.ob_t_p_t" data-v-72af3cd3></span><span id="trading-price-ob" data-v-72af3cd3></span></div></h3> <p>Тип цены, используемой при торговле, доступен только для не <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> бумаг, используется только в режимах <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook</code> и <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = <code>Orderbook + filter</code>:</p> <ul><li><strong>Deepest</strong> – цена того уровня в стакане, на котором набрали искомый объем;</li> <li><strong>Weighted avg.</strong> – средневзвешенная цена до того уровня в стакане включительно, на котором набрали искомый объем.</li></ul> <p><em>Пример:</em><br> <code>Trading price OB</code>- Deepest:</p> <p>Допустим, вы ищете в стакане на покупку 1000 лотов, по цене 100 стоит 500 лотов, потом по цене 99 стоит 490 лотов и по цене 5 стоят оставшиеся 10 лотов. При таком раскладе искомая цена будет равна 5.</p> <p><code>Trading price OB</code> - Weighted avg:</p> <p>Из примера выше (500 * 100 + 490 * 99 + 5 * 10)/1000 = 98.56 - искомая цена. Перед выставлением заявки робот округлит цену в соответствии с шагом цены данного инструмента. Для продажи выполняется округление вверх, для покупки - округление вниз. Т.е. если шаг цены в данном примере равен 1, то продавать будем по цене 99.</p> <h3 id="_5-3-33-level-to0" tabindex="-1"><a href="#_5-3-33-level-to0" class="header-anchor">#</a> 5.3.33. Level to0 <div class="anchor-container" data-v-72af3cd3><span id="s.mc_level_to0" data-v-72af3cd3></span><span id="level-to0" data-v-72af3cd3></span></div></h3> <p>Если хотя бы для одной бумаги портфеля модуль разности <a href="/bot-doc/docs/05-params-description.html#mark-price">Mark price</a> и <a href="/bot-doc/docs/05-params-description.html#liquidation-price">Liquidation price</a> строго меньше данного значения, то взвести флаг <a href="/bot-doc/docs/05-params-description.html#p.to0">To0</a> и НЕ давать его снять пока условие выполняется, когда условие перестанет выполняться - снять флаг <a href="/bot-doc/docs/05-params-description.html#p.to0">To0</a> (имеет смысл только для бумаг с BitMEX, Deribit, некоторых других). Таким образом для заданного портфеля можно запретить увеличивать позицию пока текущая цена находится в опасной близости с ценой ликвидиации.</p> <h3 id="_5-3-34-level-close" tabindex="-1"><a href="#_5-3-34-level-close" class="header-anchor">#</a> 5.3.34. Level close <div class="anchor-container" data-v-72af3cd3><span id="s.mc_level_close" data-v-72af3cd3></span><span id="level-close" data-v-72af3cd3></span></div></h3> <p>Если хотя бы для одной бумаги портфеля модуль разности <a href="/bot-doc/docs/05-params-description.html#mark-price">Mark price</a> и <a href="/bot-doc/docs/05-params-description.html#liquidation-price">Liquidation price</a> строго меньше данного значения, то взвести флаг <a href="/bot-doc/docs/05-params-description.html#p.to0">To0</a> и НЕ давать его снять пока условие выполняется (когда условие перестанет выполняться - снять флаг <a href="/bot-doc/docs/05-params-description.html#p.to0">To0</a>), раз в 5 секунд выставлять заявку в направлении закрытия позиции в объеме <a href="/bot-doc/docs/05-params-description.html#p.v_out_left">v_out_left</a> портфелей до тех пор пока описанное выше условие не перестанет выполняться или позиция по портфелю не станет равно 0 (имеет смысл только для бумаг с BitMEX, Deribit, некоторых других). Таким образом позиция для заданного портфеля уменьшается с соблюдением правил хеджирования до тех пор, пока цена ликвидации не примет безопасное значение.</p> <h3 id="_5-3-35-leverage" tabindex="-1"><a href="#_5-3-35-leverage" class="header-anchor">#</a> 5.3.35. Leverage <div class="anchor-container" data-v-72af3cd3><span id="s.leverage" data-v-72af3cd3></span><span id="leverage" data-v-72af3cd3></span></div></h3> <p>Параметр определяющий плечо для выставляемой заявки (имеет смысл только для бумаг с HBDM).</p> <h3 id="_5-3-36-decimals" tabindex="-1"><a href="#_5-3-36-decimals" class="header-anchor">#</a> 5.3.36. Decimals <div class="anchor-container" data-v-72af3cd3><span id="s.decimals" data-v-72af3cd3></span><span id="decimals" data-v-72af3cd3></span></div></h3> <p>Параметр, определяющий сколько знаков после десятичной точки отображается в параметрах, для которых значение является дробным числом.</p> <p><strong>Важно:</strong> данный параметр так же отвечает за число знаков после десятичной точки в ценах сделок по данной бумаге в таблице раздвижек. При смене значения, число знаков у уже добавленных в таблицу сделок НЕ изменится.</p> <h3 id="_5-3-37-max-trans-time" tabindex="-1"><a href="#_5-3-37-max-trans-time" class="header-anchor">#</a> 5.3.37. Max trans time <div class="anchor-container" data-v-72af3cd3><span id="s.max_trans_musec" data-v-72af3cd3></span><span id="max-trans-time" data-v-72af3cd3></span></div></h3> <p>Максимально допустимое время Round trip'a (в микросекундах) при котором вы хотите продолжить торговать текущим портфелем. Если это время будет превышено, то активируется <a href="/bot-doc/docs/05-params-description.html#s.ban_period">Ban_period</a>.</p> <h3 id="_5-3-38-ban-period" tabindex="-1"><a href="#_5-3-38-ban-period" class="header-anchor">#</a> 5.3.38. Ban period <div class="anchor-container" data-v-72af3cd3><span id="s.ban_period" data-v-72af3cd3></span><span id="ban-period" data-v-72af3cd3></span></div></h3> <p>Период, на протяжении которого робот перестает выставлять заявки по первой ноге.</p> <h2 id="_5-4-параметры-уведомлении" tabindex="-1"><a href="#_5-4-параметры-уведомлении" class="header-anchor">#</a> 5.4. Параметры уведомлений <div class="anchor-container" data-v-72af3cd3><span id="параметры-уведомлений" data-v-72af3cd3></span></div></h2> <p>Робот умеет уведомлять пользователя о наступлении определенных событий. Например, при резком падении финансового результата. Так как понятие &quot;резкое падение&quot; сильно зависит от выбранной стратегии и настроек портфеля, то для каждого портфеля настройки уведомлений задаются отдельно. Кроме чисто сигнальной функции некоторые уведомления могут выключать торговлю по соответствующему портфелю. При наступлении соответствующего события, уведомление появляется в браузере, а так же в <a href="/bot-doc/docs/03-getting-started.html#тelegram-бот">Telegram-бот</a>, если он подключен и настроен. Обращаем ваше внимание, что данные уведомления работают только при включенной торговле на портфеле. Также существуют уведомления, которые настраиваются для конкретного транзакционного подключения к бирже, они описаны в разделе <a href="/bot-doc/docs/05-params-description.html#параметры-позиций">Параметры позиций</a>.</p> <h3 id="_5-4-1-finres-fall" tabindex="-1"><a href="#_5-4-1-finres-fall" class="header-anchor">#</a> 5.4.1. FinRes fall <div class="anchor-container" data-v-72af3cd3><span id="finres-fall" data-v-72af3cd3></span></div></h3> <p>Уведомление о падении финансового результата.
<code>Fall</code> (%) - процентное изменение финансового результата о достижении которого необходимо уведомить пользователя, если оно достигнуто за <code>Time</code> (sec) секунд. При этом это изменение должно быть больше <code>Min fall</code> (pt)
<code>Stop trading</code> - вместе с уведомлением выключить торговлю по портфелю (расписание также будет выключено).</p> <h3 id="_5-4-2-lim-sell-change-и-lim-buy-change" tabindex="-1"><a href="#_5-4-2-lim-sell-change-и-lim-buy-change" class="header-anchor">#</a> 5.4.2. Lim_Sell change и Lim_Buy change <div class="anchor-container" data-v-72af3cd3><span id="lim_sell-change-и-lim_buy-change" data-v-72af3cd3></span></div></h3> <p>Уведомлять об изменении <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_Sell/Lim_Buy</a> портфеля если за <code>Time</code> секунд оно больше, чем на <code>Value</code>;</p> <ul><li><code>Time (sec)</code> - период времени в секундах;</li> <li><code>Value</code> - сигнальное значение изменения <a href="/bot-doc/docs/05-params-description.html#p.lim_s">Lim_Sell/Lim_Buy</a>;</li> <li><code>Stop trading</code> - вместе с уведомлением выключить торговлю по портфелю (расписание также будет выключено).</li></ul> <h3 id="_5-4-3-severe-sell-change-и-severe-buy-change" tabindex="-1"><a href="#_5-4-3-severe-sell-change-и-severe-buy-change" class="header-anchor">#</a> 5.4.3. Severe sell change и Severe buy change <div class="anchor-container" data-v-72af3cd3><span id="severe-sell-change-и-severe-buy-change" data-v-72af3cd3></span></div></h3> <p>Уведомлять о &quot;резком&quot; изменении <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell/Buy</a> портфеля ≥ <code>Value</code> за <code>Time</code> секунд (только когда портфель включен):</p> <ul><li><code>Time (sec)</code> - период времени, за который считать изменение <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell/Buy</a> (откладывается назад от текущего времени) как разницу между текущим <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell/Buy</a> и <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell/Buy</a> 'Time` секунд назад;</li> <li><code>Value</code> - сигнальное значение изменения <a href="/bot-doc/docs/05-params-description.html#p.sell">Sell/Buy</a>.</li></ul> <h3 id="_5-4-4-too-much-running-orders" tabindex="-1"><a href="#_5-4-4-too-much-running-orders" class="header-anchor">#</a> 5.4.4. Too much running orders <div class="anchor-container" data-v-72af3cd3><span id="too-much-running-orders" data-v-72af3cd3></span></div></h3> <p>Уведомлять о слишком большом количестве активных заявок по не <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструментам портфеля
(max (число активных заявок по каждому из не <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструментов портфеля) ≥ Percent * <a href="/bot-doc/docs/05-params-description.html#p.max_not_hedged">Max not hedged</a> * 0.01, где <a href="/bot-doc/docs/05-params-description.html#p.max_not_hedged">Max not hedged</a> по умолчанию равен 30).</p> <ul><li><code>Percent (%)</code> - сигнальный процент.</li></ul> <h3 id="_5-4-5-too-much-not-hedged" tabindex="-1"><a href="#_5-4-5-too-much-not-hedged" class="header-anchor">#</a> 5.4.5. Too much not hedged <div class="anchor-container" data-v-72af3cd3><span id="too-much-not-hedged" data-v-72af3cd3></span></div></h3> <p>Уведомлять о слишком большой не захеджированной позиции по <a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a> инструменту портфеля:</p> <ul><li><code>Limit portfolios</code> - сигнальное значение не захеджированной позиции (вычисляется в штуках портфелей).</li></ul> <h3 id="_5-4-6-severe-pos-change" tabindex="-1"><a href="#_5-4-6-severe-pos-change" class="header-anchor">#</a> 5.4.6. Severe pos change <div class="anchor-container" data-v-72af3cd3><span id="severe-pos-change" data-v-72af3cd3></span></div></h3> <p>Уведомлять о &quot;резком&quot; изменении позиции <code>Pos</code> по портфелю ≥ <code>Value</code> за <code>Time</code> секунд:</p> <ul><li><code>Time (sec)</code> - период времени, за который считать изменение позиции (откладывается назад от текущего времени) как разницу между текущей позицией и позицией <code>Time</code> секунд назад;</li> <li><code>Value</code> - сигнальное значение изменения позиции.</li></ul> <h2 id="_5-5-параметры-позиции" tabindex="-1"><a href="#_5-5-параметры-позиции" class="header-anchor">#</a> 5.5. Параметры позиций <div class="anchor-container" data-v-72af3cd3><span id="параметры-позиций" data-v-72af3cd3></span></div></h2> <h3 id="_5-5-1-параметры-позиции-по-инструментам" tabindex="-1"><a href="#_5-5-1-параметры-позиции-по-инструментам" class="header-anchor">#</a> 5.5.1. Параметры позиций по инструментам <div class="anchor-container" data-v-72af3cd3><span id="параметры-позиций-по-инструментам" data-v-72af3cd3></span></div></h3> <p>Параметры позиций по инструментам отображаются отдельно для каждого подключения во вкладке Positions/Balance данного подключения и представляют собой таблицу. Строчки таблицы - это инструменты данного подключения, используемые в портфелях робота. Если через данное транзакционное подключение доступны несколько клиентских кодов, то строчка будет соответствовать паре (код клиента, инструмент). Инструменты с нулевой позицией могут быть скрыты (для этого нужно снять флаг <code>Show_zero_poses</code>). Далее приведены описания столбцов таблицы, предполагается что параметры являются редактируемыми, если прямо не указано иное.</p> <h4 id="_5-5-1-1-seckey" tabindex="-1"><a href="#_5-5-1-1-seckey" class="header-anchor">#</a> 5.5.1.1. SecKey <div class="anchor-container" data-v-72af3cd3><span id="seckey" data-v-72af3cd3></span></div></h4> <p>Уникальный идентификатор инструмента. Соответствует параметру инструментов портфеля <a href="/bot-doc/docs/05-params-description.html#s.sec_key">SecKey</a>. Нередактируемый параметр.</p> <h4 id="_5-5-1-2-seccode" tabindex="-1"><a href="#_5-5-1-2-seccode" class="header-anchor">#</a> 5.5.1.2. SecCode <div class="anchor-container" data-v-72af3cd3><span id="seccode" data-v-72af3cd3></span></div></h4> <p>Код инструмента. Соответствует параметру инструментов портфеля <a href="/bot-doc/docs/05-params-description.html#s.sec_code">SecCode</a>. Нередактируемый параметр.</p> <h4 id="_5-5-1-3-pos" tabindex="-1"><a href="#_5-5-1-3-pos" class="header-anchor">#</a> 5.5.1.3. Pos <div class="anchor-container" data-v-72af3cd3><span id="pos" data-v-72af3cd3></span></div></h4> <p>Позиция на бирже по инструменту. Нередактируемый параметр.</p> <h4 id="_5-5-1-4-robot-pos" tabindex="-1"><a href="#_5-5-1-4-robot-pos" class="header-anchor">#</a> 5.5.1.4. Robot pos <div class="anchor-container" data-v-72af3cd3><span id="robot-pos" data-v-72af3cd3></span></div></h4> <p>Суммарная позиция инструмента в роботе со всех портфелей, торгующих через данное подключение указанной бумагой с данным кодом клиента. Нередактируемый параметр.</p> <h4 id="_5-5-1-5-mark-price" tabindex="-1"><a href="#_5-5-1-5-mark-price" class="header-anchor">#</a> 5.5.1.5. Mark price <div class="anchor-container" data-v-72af3cd3><span id="mark-price" data-v-72af3cd3></span></div></h4> <p>&quot;Сигнальная&quot; цена инструмента. Нередактируемый параметр.
Если <code>Mark price</code> достигнет <code>Liquidation price</code>, то позиция по инструменту будет принудительно закрыта биржей.</p> <h4 id="_5-5-1-6-liquidation-price" tabindex="-1"><a href="#_5-5-1-6-liquidation-price" class="header-anchor">#</a> 5.5.1.6. Liquidation price <div class="anchor-container" data-v-72af3cd3><span id="liquidation-price" data-v-72af3cd3></span></div></h4> <p>Цена ликвидации по инструменту. Нередактируемый параметр.
Если <code>Mark price</code> достигнет <code>Liquidation price</code>, то позиция по инструменту будет принудительно закрыта биржей.</p> <h4 id="_5-5-1-7-pos-lag" tabindex="-1"><a href="#_5-5-1-7-pos-lag" class="header-anchor">#</a> 5.5.1.7. Pos lag <div class="anchor-container" data-v-72af3cd3><span id="pos-lag" data-v-72af3cd3></span></div></h4> <p>Значение с которым будет сравниваться разница между <code>Pos</code> и <code>Robot pos</code>, само сравнение и дальнейшие действия определяются параметром <a href="/bot-doc/docs/05-params-description.html#check-equality">Check equality</a>.</p> <h4 id="_5-5-1-8-check-equality" tabindex="-1"><a href="#_5-5-1-8-check-equality" class="header-anchor">#</a> 5.5.1.8. Check equality <div class="anchor-container" data-v-72af3cd3><span id="check-equality" data-v-72af3cd3></span></div></h4> <p>Если флаг взведен, то в случае, если произойдет следующая ситуация:</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mo>−</mo><mi>r</mi><mi>o</mi><mi>b</mi><mi>o</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo>≠</mo><mi>p</mi><mi>o</mi><mi>s</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>a</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">pos-robot\_pos\neq pos\_lag</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.716em;"></span><span class="strut bottom" style="height:1.026em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">b</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mrel">≠</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span></p> <p>в логе вам будут приходить оповещения о том, что позиция на бирже и позиция в роботе не совпадают.
(<code>pos</code> - позиция на бирже, а <code>robot_pos</code> - позиция в роботе по портфелям, торгующим данной бумагой на данном подключении)
Если флаг не взведен, то оповещения будут приходить только в случае, если:</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo>−</mo><mi>r</mi><mi>o</mi><mi>b</mi><mi>o</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi mathvariant="normal">∣</mi><mo>&gt;</mo><mi>p</mi><mi>o</mi><mi>s</mi><mi mathvariant="normal">_</mi><mi>l</mi><mi>a</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">|pos-robot\_pos|&gt;pos\_lag</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">b</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathrm">∣</span><span class="mrel">&gt;</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span>$</p> <h4 id="_5-5-1-9-tgr-notify" tabindex="-1"><a href="#_5-5-1-9-tgr-notify" class="header-anchor">#</a> 5.5.1.9. Tgr notify <div class="anchor-container" data-v-72af3cd3><span id="tgr-notify" data-v-72af3cd3></span></div></h4> <p>Если флаг взведен, то отправлять уведомления о несовпадении позиции робота и биржи в Telegram.</p> <h4 id="_5-5-1-10-pos-leveling" tabindex="-1"><a href="#_5-5-1-10-pos-leveling" class="header-anchor">#</a> 5.5.1.10. Pos leveling <div class="anchor-container" data-v-72af3cd3><span id="pos-leveling" data-v-72af3cd3></span></div></h4> <p>Выставить заявку с заданными направлением, ценой и объёмом. Направление и объём по умолчанию задаются такими, чтобы выровнить позицию биржи относительно позиции робота (эта заявка не изменяет позиции по бумагам в портфелях робота).</p> <h3 id="_5-5-2-параметры-позиции-по-валютам" tabindex="-1"><a href="#_5-5-2-параметры-позиции-по-валютам" class="header-anchor">#</a> 5.5.2. Параметры позиций по валютам <div class="anchor-container" data-v-72af3cd3><span id="параметры-позиций-по-валютам" data-v-72af3cd3></span></div></h3> <p>Параметры позиций по валютам отображаются отдельно для каждого подключения во вкладке Positions/Balance данного подключения и представляют собой таблицу. Строчки таблицы это валюты/криптовалюты, входящие в состав инструментов, торгуемых с помощью данного подключения и используемых в портфелях робота. Если через данное транзакционное подключение доступны несколько клиентских кодов, то строчка будет соответствовать паре (код клиента, валюта). Валюты с нулевым балансом могут быть скрыты (для этого нужно снять флаг Show zero poses). Далее приведены описания столбцов таблицы, предполагается что параметры являются редактируемыми, если прямо не указано иное.</p> <h4 id="_5-5-2-1-currency" tabindex="-1"><a href="#_5-5-2-1-currency" class="header-anchor">#</a> 5.5.2.1. Currency <div class="anchor-container" data-v-72af3cd3><span id="currency" data-v-72af3cd3></span></div></h4> <p>Краткое наименование валюты/криптовалюты.</p> <h4 id="_5-5-2-2-limit" tabindex="-1"><a href="#_5-5-2-2-limit" class="header-anchor">#</a> 5.5.2.2. Limit <div class="anchor-container" data-v-72af3cd3><span id="limit" data-v-72af3cd3></span></div></h4> <p>Лимит по валюте.</p> <h2 id="_5-6-список-проверок-параметров-портфеля-при-создании-редактировании-портфеля-бумаги" tabindex="-1"><a href="#_5-6-список-проверок-параметров-портфеля-при-создании-редактировании-портфеля-бумаги" class="header-anchor">#</a> 5.6. Список проверок параметров портфеля при создании/редактировании портфеля/бумаги <div class="anchor-container" data-v-72af3cd3><span id="список-проверок-параметров-портфеля-при-создании/редактировании-портфеля/бумаги" data-v-72af3cd3></span></div></h2> <p>Если условие в списке ниже ИСТИННО, то такие настройки НЕ валидны:</p> <h3 id="_5-6-1-для-портфеля" tabindex="-1"><a href="#_5-6-1-для-портфеля" class="header-anchor">#</a> 5.6.1. Для портфеля <div class="anchor-container" data-v-72af3cd3><span id="для-портфеля" data-v-72af3cd3></span></div></h3> <ol><li><p>Параметр <a href="/bot-doc/docs/05-params-description.html#p.quote">Quote</a> выключен, а <a href="/bot-doc/docs/05-params-description.html#p.simply_first">Simply first</a> включен;</p></li> <li><p>Сборка робота без поддержки стаканов и включен параметр <a href="/bot-doc/docs/05-params-description.html#p.simply_first">Simply first</a>;</p></li> <li><p>Сборка робота без поддержки стаканов и значение параметра <a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a> = bid/offer;</p></li> <li><p>Выключен параметр <a href="/bot-doc/docs/05-params-description.html#p.quote">Quote</a> и включен <a href="/bot-doc/docs/05-params-description.html#p.maker">Only maker</a>;</p></li> <li><p>Значение параметра <a href="/bot-doc/docs/05-params-description.html#p.max_not_hedged">Max not hedged</a> &gt; 1 и позиция по бумаге на бирже стоит отдельно на покупку и на продажу;</p></li> <li><p>Значения параметров <a href="/bot-doc/docs/05-params-description.html#p.v_min">v_min/v_max</a> имеют разные знаки (или одно из них = 0) и позиция по бумаге на бирже стоит отдельно на покупку и на продажу;</p></li></ol> <h3 id="_5-6-2-для-инструмента" tabindex="-1"><a href="#_5-6-2-для-инструмента" class="header-anchor">#</a> 5.6.2. Для инструмента <div class="anchor-container" data-v-72af3cd3><span id="для-инструмента" data-v-72af3cd3></span></div></h3> <ol><li><p>Для бумаг OKEX-SPOT: Сlient code не оканчивается на &quot;/cash&quot;, &quot;/cross_base&quot;, &quot;/cross_quote&quot;, &quot;/isolated&quot; и не должен быть “virtual”;</p></li> <li><p>Для бумаг OKEX-FUT: Сlient code не оканчивается на &quot;/cross&quot; или &quot;/isolated&quot; и не должен быть “virtual”;</p></li> <li><p>Для первой ноги  <a href="/bot-doc/docs/05-params-description.html#s.count_type">Count type</a> = constant и  <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> = 0;</p></li> <li><p>Для первой ноги <a href="/bot-doc/docs/05-params-description.html#s.on_buy">On_by</a> = Sell;</p></li> <li><p>Выбрано пустое значение для <a href="/bot-doc/docs/05-params-description.html#s.client_code">Сlient code</a> и <a href="/bot-doc/docs/05-params-description.html#s.count">Count</a> не 0;</p></li></ol> <h3 id="_5-6-3-запрещается-менять-следующие-параметры-портфеля-когда-он-торгует-или-есть-активные-заявки" tabindex="-1"><a href="#_5-6-3-запрещается-менять-следующие-параметры-портфеля-когда-он-торгует-или-есть-активные-заявки" class="header-anchor">#</a> 5.6.3. Запрещается менять следующие параметры портфеля, когда он торгует или есть активные заявки <div class="anchor-container" data-v-72af3cd3><span id="запрещается-менять-следующие-параметры-портфеля,-когда-он-торгует-или-есть-активные-заявки" data-v-72af3cd3></span></div></h3> <ol><li><p><a href="/bot-doc/docs/05-params-description.html#s.is_first">Is first</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.client_code">Client code</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.on_buy">On_by</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.leverage">Leverage</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.pos">Curpos</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.count">Count</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.count_formula">Count formula</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.tp">TP</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.ratio">Ratio</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.ratio_type">Ratio type</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.ratio_sign">Ratio sign</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.ratio_b_formula">Ratio buy formula</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#s.ratio_s_formula">Ratio sell formula</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.custom_trade'">Custom trade</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.ext_formulas">Extra formulas</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.trade_formula">Trade formula</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.ext_field1_">Extra field#1</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.ext_field2_">Extra field#2</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.type_trade">Type trade</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.price_type">Type price</a></p></li> <li><p><a href="/bot-doc/docs/05-params-description.html#p.type">Type</a></p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/bot-doc/docs/04-creating-connection.html" class="prev">
        4. Добавление подключений
      </a></span> <span class="next"><a href="/bot-doc/docs/06-algorithm-comments.html">
        6. Примечания к алгоритму
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/bot-doc/assets/js/app.e81ab8fa.js" defer></script><script src="/bot-doc/assets/js/3.5b3b6265.js" defer></script><script src="/bot-doc/assets/js/6.8be4ae1f.js" defer></script><script src="/bot-doc/assets/js/10.8c8ad779.js" defer></script>
  </body>
</html>
